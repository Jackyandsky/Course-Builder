(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4095],{3348:function(e,t,s){Promise.resolve().then(s.bind(s,9829))},78030:function(e,t,s){"use strict";s.d(t,{Z:function(){return d}});var n=s(2265);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),l=e=>{let t=a(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()},c=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var u={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,n.forwardRef)((e,t)=>{let{color:s="currentColor",size:r=24,strokeWidth:a=2,absoluteStrokeWidth:l,className:o="",children:d,iconNode:h,...f}=e;return(0,n.createElement)("svg",{ref:t,...u,width:r,height:r,stroke:s,strokeWidth:l?24*Number(a)/Number(r):a,className:i("lucide",o),...!d&&!c(f)&&{"aria-hidden":"true"},...f},[...h.map(e=>{let[t,s]=e;return(0,n.createElement)(t,s)}),...Array.isArray(d)?d:[d]])}),d=(e,t)=>{let s=(0,n.forwardRef)((s,a)=>{let{className:c,...u}=s;return(0,n.createElement)(o,{ref:a,iconNode:t,className:i("lucide-".concat(r(l(e))),"lucide-".concat(e),c),...u})});return s.displayName=l(e),s}},24241:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(78030).Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},42421:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(78030).Z)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},70518:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(78030).Z)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},87592:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(78030).Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},14392:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(78030).Z)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]])},63550:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(78030).Z)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},65607:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(78030).Z)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]])},92513:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(78030).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},54817:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(78030).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},74697:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(78030).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},16463:function(e,t,s){"use strict";var n=s(71169);s.o(n,"useParams")&&s.d(t,{useParams:function(){return n.useParams}}),s.o(n,"usePathname")&&s.d(t,{usePathname:function(){return n.usePathname}}),s.o(n,"useRouter")&&s.d(t,{useRouter:function(){return n.useRouter}})},9829:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var n=s(57437),r=s(2265),a=s(16463),l=s(92513),i=s(24241),c=s(50586),u=s(2318);function o(){let e=(0,a.useRouter)(),[t,s]=(0,r.useState)([]),[o,d]=(0,r.useState)(!0);(0,r.useEffect)(()=>{h()},[]);let h=async()=>{try{d(!0);let e=await c.y.getSchedules({});s(e)}catch(e){console.error("Failed to load schedules:",e)}finally{d(!1)}};return(0,n.jsxs)("div",{className:"space-y-6 p-6",children:[(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Schedules"}),(0,n.jsx)("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"Manage your course schedules and lesson plans."})]}),(0,n.jsx)(u.zx,{onClick:()=>e.push("/schedules/new"),leftIcon:(0,n.jsx)(l.Z,{className:"h-4 w-4"}),children:"Create Schedule"})]}),(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsx)(u.Rj,{placeholder:"Search schedules...",onSearch:e=>{h()},fullWidth:!0})}),o?(0,n.jsx)("div",{className:"flex justify-center py-12",children:(0,n.jsx)(u.$j,{size:"lg"})}):0===t.length?(0,n.jsxs)(u.Zb,{className:"p-12 text-center",children:[(0,n.jsx)(i.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"No schedules found"}),(0,n.jsx)("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Get started by creating your first schedule."}),(0,n.jsx)(u.zx,{className:"mt-4",onClick:()=>e.push("/schedules/new"),leftIcon:(0,n.jsx)(l.Z,{className:"h-4 w-4"}),children:"Create Schedule"})]}):(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(t=>{var s;return(0,n.jsx)(u.Zb,{className:"hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>e.push("/schedules/".concat(t.id)),children:(0,n.jsxs)(u.Zb.Content,{className:"p-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900 line-clamp-1",children:t.name}),t.description&&(0,n.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2 mt-1",children:t.description}),(0,n.jsxs)("div",{className:"mt-3 flex justify-between items-center text-sm text-gray-500",children:[(0,n.jsx)("span",{children:(null===(s=t.course)||void 0===s?void 0:s.title)||"No Course"}),(0,n.jsx)(u.Ct,{variant:t.is_active?"success":"secondary",children:t.is_active?"Active":"Inactive"})]})]})},t.id)})})]})}},50586:function(e,t,s){"use strict";s.d(t,{y:function(){return a}});var n=s(64392);class r{async getSchedules(e){let t=this.supabase.from("schedules").select("\n        *,\n        course:courses(id, title, description),\n        lessons(count)\n      ").order("created_at",{ascending:!1});(null==e?void 0:e.course_id)&&(t=t.eq("course_id",e.course_id)),(null==e?void 0:e.is_active)!==void 0&&(t=t.eq("is_active",e.is_active)),(null==e?void 0:e.user_id)&&(t=t.eq("user_id",e.user_id));let{data:s,error:n}=await t;if(n)throw n;return s}async getSchedule(e){let{data:t,error:s}=await this.supabase.from("schedules").select("\n        *,\n        course:courses(*),\n        lessons(\n          *,\n          objectives:lesson_objectives(\n            *,\n            objective:objectives(*)\n          ),\n          methods:lesson_methods(\n            *,\n            method:methods(*)\n          ),\n          tasks:lesson_tasks(\n            *,\n            task:tasks(*)\n          )\n        )\n      ").eq("id",e).single();if(s)throw s;return t}async createSchedule(e){let{data:t,error:s}=await this.supabase.from("schedules").insert(e).select().single();if(s)throw s;return"none"!==e.recurrence_type&&t&&await this.generateRecurringLessons(t.id,e),t}async updateSchedule(e,t){let{data:s,error:n}=await this.supabase.from("schedules").update(t).eq("id",e).select().single();if(n)throw n;return s}async deleteSchedule(e){let{error:t}=await this.supabase.from("schedules").delete().eq("id",e);if(t)throw t}async getLessons(e){let t=this.supabase.from("lessons").select("\n        *,\n        schedule:schedules(\n          *,\n          course:courses(id, title)\n        ),\n        attendance(count)\n      ").order("date",{ascending:!0}).order("start_time",{ascending:!0});(null==e?void 0:e.schedule_id)&&(t=t.eq("schedule_id",e.schedule_id)),(null==e?void 0:e.status)&&(t=t.eq("status",e.status)),(null==e?void 0:e.date_from)&&(t=t.gte("date",e.date_from)),(null==e?void 0:e.date_to)&&(t=t.lte("date",e.date_to)),(null==e?void 0:e.user_id)&&(t=t.eq("user_id",e.user_id));let{data:s,error:n}=await t;if(n)throw n;return s}async getLesson(e){let{data:t,error:s}=await this.supabase.from("lessons").select("\n        *,\n        schedule:schedules(\n          *,\n          course:courses(*)\n        ),\n        attendance(*),\n        objectives:lesson_objectives(\n          *,\n          objective:objectives(*)\n        ),\n        methods:lesson_methods(\n          *,\n          method:methods(*)\n        ),\n        tasks:lesson_tasks(\n          *,\n          task:tasks(*)\n        )\n      ").eq("id",e).single();if(s)throw s;return t}async createLesson(e){let{data:t,error:s}=await this.supabase.from("lessons").insert(e).select().single();if(s)throw s;return t}async updateLesson(e,t){let{data:s,error:n}=await this.supabase.from("lessons").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw n;return s}async deleteLesson(e){let{error:t}=await this.supabase.from("lessons").delete().eq("id",e);if(t)throw t}async getAttendance(e){let{data:t,error:s}=await this.supabase.from("attendance").select("*").eq("lesson_id",e).order("student_name");if(s)throw s;return t}async markAttendance(e){let{data:t,error:s}=await this.supabase.from("attendance").upsert({...e,marked_at:new Date().toISOString()}).select().single();if(s)throw s;return t}async bulkMarkAttendance(e,t){let s=t.map(t=>({...t,lesson_id:e,marked_at:new Date().toISOString()})),{data:n,error:r}=await this.supabase.from("attendance").upsert(s).select();if(r)throw r;return n}async generateRecurringLessons(e,t){let s=[],n=new Date(t.start_date),r=new Date(t.end_date?t.end_date:n);r.setMonth(r.getMonth()+3);let a=new Date(n),l=1;for(;a<=r;){if(this.shouldCreateLesson(a,t)){let[n,r]=t.default_start_time.split(":").map(Number),i=new Date(a);i.setHours(n,r,0,0);let c=new Date(i);c.setMinutes(c.getMinutes()+t.default_duration_minutes),s.push({schedule_id:e,title:"".concat(t.name," - Lesson ").concat(l),date:a.toISOString().split("T")[0],start_time:i.toTimeString().slice(0,5),end_time:c.toTimeString().slice(0,5),duration_minutes:t.default_duration_minutes,location:t.location,status:"scheduled",user_id:t.user_id}),l++}a=this.getNextLessonDate(a,t)}if(s.length>0){let{error:e}=await this.supabase.from("lessons").insert(s);if(e)throw e}}shouldCreateLesson(e,t){if("none"===t.recurrence_type)return!0;let s=e.toLocaleDateString("en-US",{weekday:"long"}).toLowerCase();return!t.recurrence_days||!(t.recurrence_days.length>0)||t.recurrence_days.includes(s)}getNextLessonDate(e,t){let s=new Date(e);return s.setDate(s.getDate()+1),s}transformToCalendarEvents(e){return e.map(e=>{let t=new Date("".concat(e.date,"T").concat(e.start_time)),s=new Date("".concat(e.date,"T").concat(e.end_time));return{id:e.id,title:e.title,start:t,end:s,resource:{lesson:e,schedule:e.schedule},className:this.getLessonClassName(e.status)}})}getLessonClassName(e){switch(e){case"completed":return"bg-green-100 border-green-300 text-green-800";case"cancelled":return"bg-red-100 border-red-300 text-red-800";case"draft":return"bg-gray-100 border-gray-300 text-gray-800";default:return"bg-blue-100 border-blue-300 text-blue-800"}}async getScheduleStats(e){let{data:t,error:s}=await this.supabase.from("lessons").select("status, attendance(status)").eq("schedule_id",e);if(s)throw s;let n={total_lessons:(null==t?void 0:t.length)||0,completed_lessons:(null==t?void 0:t.filter(e=>"completed"===e.status).length)||0,cancelled_lessons:(null==t?void 0:t.filter(e=>"cancelled"===e.status).length)||0,scheduled_lessons:(null==t?void 0:t.filter(e=>"scheduled"===e.status).length)||0,attendance_rate:0},r=(null==t?void 0:t.flatMap(e=>e.attendance||[]))||[],a=r.filter(e=>"present"===e.status).length;return r.length>0&&(n.attendance_rate=Math.round(a/r.length*100)),n}constructor(){this.supabase=(0,n.createClientComponentClient)()}}let a=new r},13027:function(e,t,s){"use strict";s.d(t,{j:function(){return l}});var n=s(44839);let r=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,a=n.W,l=(e,t)=>s=>{var n;if((null==t?void 0:t.variants)==null)return a(e,null==s?void 0:s.class,null==s?void 0:s.className);let{variants:l,defaultVariants:i}=t,c=Object.keys(l).map(e=>{let t=null==s?void 0:s[e],n=null==i?void 0:i[e];if(null===t)return null;let a=r(t)||r(n);return l[e][a]}),u=s&&Object.entries(s).reduce((e,t)=>{let[s,n]=t;return void 0===n||(e[s]=n),e},{});return a(e,c,null==t?void 0:null===(n=t.compoundVariants)||void 0===n?void 0:n.reduce((e,t)=>{let{class:s,className:n,...r}=t;return Object.entries(r).every(e=>{let[t,s]=e;return Array.isArray(s)?s.includes({...i,...u}[t]):({...i,...u})[t]===s})?[...e,s,n]:e},[]),null==s?void 0:s.class,null==s?void 0:s.className)}},44839:function(e,t,s){"use strict";function n(){for(var e,t,s=0,n="",r=arguments.length;s<r;s++)(e=arguments[s])&&(t=function e(t){var s,n,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==typeof t){if(Array.isArray(t)){var a=t.length;for(s=0;s<a;s++)t[s]&&(n=e(t[s]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n)}return r}(e))&&(n&&(n+=" "),n+=t);return n}s.d(t,{W:function(){return n}})}},function(e){e.O(0,[4392,8409,2318,2971,7023,1744],function(){return e(e.s=3348)}),_N_E=e.O()}]);