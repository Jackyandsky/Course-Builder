(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[678],{31588:function(e,t,r){Promise.resolve().then(r.bind(r,24739))},78030:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var a=r(2265);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),i=e=>{let t=s(e);return t.charAt(0).toUpperCase()+t.slice(1)},l=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},c=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:n=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:u="",children:d,iconNode:h,...m}=e;return(0,a.createElement)("svg",{ref:t,...o,width:n,height:n,stroke:r,strokeWidth:i?24*Number(s)/Number(n):s,className:l("lucide",u),...!d&&!c(m)&&{"aria-hidden":"true"},...m},[...h.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),d=(e,t)=>{let r=(0,a.forwardRef)((r,s)=>{let{className:c,...o}=r;return(0,a.createElement)(u,{ref:s,iconNode:t,className:l("lucide-".concat(n(i(e))),"lucide-".concat(e),c),...o})});return r.displayName=i(e),r}},95137:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(78030).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6540:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(78030).Z)("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]])},42421:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(78030).Z)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},70518:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(78030).Z)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},87592:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(78030).Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},14392:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(78030).Z)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]])},63550:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(78030).Z)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},65607:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(78030).Z)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]])},4436:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(78030).Z)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]])},74453:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(78030).Z)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},54817:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(78030).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},6649:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(78030).Z)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},10883:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(78030).Z)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},11240:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(78030).Z)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},74697:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(78030).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},16463:function(e,t,r){"use strict";var a=r(71169);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},24739:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var a=r(57437),n=r(2265),s=r(16463),i=r(95137),l=r(6540),c=r(4436),o=r(74453),u=r(6649),d=r(10883),h=r(11240),m=r(46749),x=r(2318),g=r(64392);function f(){let e=(0,s.useRouter)(),t=(0,s.useParams)(),r=(0,g.createClientComponentClient)(),f=t.id,[y,p]=(0,n.useState)(null),[v,j]=(0,n.useState)(!0),[b,k]=(0,n.useState)(!1),[w,N]=(0,n.useState)(!1),[_,Z]=(0,n.useState)([]),[C,D]=(0,n.useState)(!1);(0,n.useEffect)(()=>{f&&(A(),z())},[f]);let A=async()=>{j(!0);try{let e=await m.a.getBook(f);p(e)}catch(t){console.error("Failed to load book:",t),e.push("/books")}finally{j(!1)}},z=async()=>{D(!0);try{let{data:e,error:t}=await r.from("vocabulary_group_books").select("\n          vocabulary_group:vocabulary_groups(\n            id,\n            name,\n            description,\n            difficulty,\n            language,\n            target_language\n          )\n        ").eq("book_id",f);if(t)throw t;let a=(null==e?void 0:e.map(e=>e.vocabulary_group).filter(Boolean))||[];Z(a)}catch(e){console.error("Failed to load vocabulary groups:",e)}finally{D(!1)}},q=async()=>{k(!0);try{await m.a.deleteBook(f),e.push("/books"),e.refresh()}catch(e){console.error("Failed to delete book:",e)}finally{k(!1),N(!1)}};return v?(0,a.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,a.jsx)(x.$j,{size:"lg"})}):y?(0,a.jsxs)("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)(x.zx,{variant:"ghost",size:"sm",onClick:()=>e.push("/books"),leftIcon:(0,a.jsx)(i.Z,{className:"h-4 w-4"}),className:"mb-4",children:"Back to Books"}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-6",children:[(0,a.jsxs)("div",{className:"flex items-start gap-6",children:[y.cover_image_url?(0,a.jsx)("img",{src:y.cover_image_url,alt:y.title,className:"w-40 h-56 rounded-lg object-cover shadow-lg"}):(0,a.jsx)("div",{className:"w-40 h-56 rounded-lg bg-gray-200 flex items-center justify-center",children:(0,a.jsx)(l.Z,{className:"w-16 h-16 text-gray-400"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:y.title}),y.author&&(0,a.jsxs)("p",{className:"text-lg text-gray-600 mt-1",children:["by ",y.author]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-4",children:[(0,a.jsxs)(x.Ct,{variant:y.is_public?"success":"secondary",children:[y.is_public?(0,a.jsx)(c.Z,{className:"h-4 w-4 mr-1.5"}):(0,a.jsx)(o.Z,{className:"h-4 w-4 mr-1.5"}),y.is_public?"Public":"Private"]}),y.category&&(0,a.jsx)(x.Ct,{style:{backgroundColor:"".concat(y.category.color,"20"),color:y.category.color},children:y.category.name})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[(0,a.jsx)(x.zx,{variant:"outline",onClick:()=>e.push("/books/".concat(f,"/edit")),leftIcon:(0,a.jsx)(u.Z,{className:"h-4 w-4"}),children:"Edit"}),(0,a.jsx)(x.zx,{variant:"danger",onClick:()=>N(!0),leftIcon:(0,a.jsx)(d.Z,{className:"h-4 w-4"}),className:"text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",children:"Delete"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(x.Zb,{children:[(0,a.jsx)(x.Zb.Header,{children:(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Description"})}),(0,a.jsx)(x.Zb.Content,{children:(0,a.jsx)("div",{className:"prose prose-sm max-w-none dark:prose-invert",children:y.description||(0,a.jsx)("p",{className:"text-gray-500 italic",children:"No description provided."})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)(x.Zb,{children:[(0,a.jsx)(x.Zb.Header,{children:(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Details"})}),(0,a.jsx)(x.Zb.Content,{children:(0,a.jsxs)("dl",{className:"space-y-3 text-sm",children:[y.publisher&&(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"font-medium text-gray-500",children:"Publisher"}),(0,a.jsx)("dd",{children:y.publisher})]}),y.publication_year&&(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"font-medium text-gray-500",children:"Year"}),(0,a.jsx)("dd",{children:y.publication_year})]}),y.language&&(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"font-medium text-gray-500",children:"Language"}),(0,a.jsx)("dd",{className:"uppercase",children:y.language})]}),y.content_type&&(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"font-medium text-gray-500",children:"Content Type"}),(0,a.jsx)("dd",{className:"capitalize",children:y.content_type})]})]})})]}),y.tags&&y.tags.length>0&&(0,a.jsxs)(x.Zb,{children:[(0,a.jsx)(x.Zb.Header,{children:(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Tags"})}),(0,a.jsx)(x.Zb.Content,{children:(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:y.tags.map(e=>(0,a.jsx)(x.Ct,{children:e},e))})})]})]}),(0,a.jsxs)(x.Zb,{children:[(0,a.jsxs)(x.Zb.Header,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(h.Z,{className:"h-5 w-5"}),(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Related Vocabulary Groups"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Vocabulary groups that contain words from this book"})]}),(0,a.jsx)(x.Zb.Content,{children:C?(0,a.jsx)("div",{className:"flex justify-center py-8",children:(0,a.jsx)(x.$j,{size:"md"})}):0===_.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-gray-500",children:"No vocabulary groups are associated with this book."}),(0,a.jsx)(x.zx,{variant:"outline",size:"sm",onClick:()=>e.push("/books/".concat(f,"/edit")),className:"mt-3",children:"Add Vocabulary Groups"})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3",children:_.map(t=>(0,a.jsx)("div",{className:"border rounded-lg p-3 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>e.push("/vocabulary/groups/".concat(t.id)),children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsx)("h4",{className:"font-medium text-sm line-clamp-2 flex-1",title:t.name,children:t.name})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(x.Ct,{variant:"secondary",className:"text-xs",children:t.difficulty}),t.language&&t.target_language&&(0,a.jsxs)(x.Ct,{variant:"outline",className:"text-xs",children:[t.language," → ",t.target_language]})]}),t.description&&(0,a.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 line-clamp-2",title:t.description,children:t.description})]})},t.id))})})]})]}),(0,a.jsxs)(x.u_,{isOpen:w,onClose:()=>N(!1),title:"Delete Book",className:"max-w-md",children:[(0,a.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:['Are you sure you want to delete "',y.title,'"? This action cannot be undone.']}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,a.jsx)(x.zx,{variant:"outline",onClick:()=>N(!1),children:"Cancel"}),(0,a.jsx)(x.zx,{variant:"danger",onClick:q,loading:b,children:"Delete Book"})]})]})]}):null}},46749:function(e,t,r){"use strict";r.d(t,{a:function(){return n}});let a=(0,r(64392).createClientComponentClient)(),n={async getBooks(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=a.from("books").select("\n        *,\n        category:categories(id, name, color, icon),\n        vocabulary_group_books(\n          vocabulary_group:vocabulary_groups(\n            id,\n            name,\n            difficulty\n          )\n        )\n      ").order("created_at",{ascending:!1});e.search&&(t=t.or("title.ilike.%".concat(e.search,"%,author.ilike.%").concat(e.search,"%,description.ilike.%").concat(e.search,"%"))),e.author&&(t=t.ilike("author","%".concat(e.author,"%"))),e.categoryId&&(t=t.eq("category_id",e.categoryId)),e.contentType&&(t=t.eq("content_type",e.contentType)),e.language&&(t=t.eq("language",e.language)),e.publicationYear&&(t=t.eq("publication_year",e.publicationYear)),void 0!==e.isPublic&&(t=t.eq("is_public",e.isPublic)),e.tags&&e.tags.length>0&&(t=t.contains("tags",e.tags));let{data:r,error:n}=await t;if(n)throw n;return r},async getBook(e){let{data:t,error:r}=await a.from("books").select("\n        *,\n        category:categories(id, name, color, icon),\n        course_books(\n          id,\n          course_id,\n          is_required,\n          notes,\n          position,\n          course:courses(id, title, status)\n        )\n      ").eq("id",e).single();if(r)throw r;return t},async createBook(e){let{data:t}=await a.auth.getUser();if(!t.user)throw Error("User not authenticated");let r={...e,language:e.language||"en",is_public:e.is_public||!1,user_id:t.user.id},{data:n,error:s}=await a.from("books").insert(r).select().single();if(s)throw s;return n},async updateBook(e){let{id:t,...r}=e,{data:n,error:s}=await a.from("books").update({...r,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(s)throw s;return n},async deleteBook(e){let{error:t}=await a.from("books").delete().eq("id",e);if(t)throw t},async getBookStats(){let{data:e}=await a.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:r}=await a.from("books").select("content_type",{count:"exact"}).eq("user_id",e.user.id);if(r)throw r;return{total:(null==t?void 0:t.length)||0,text:(null==t?void 0:t.filter(e=>"text"===e.content_type).length)||0,video:(null==t?void 0:t.filter(e=>"video"===e.content_type).length)||0,audio:(null==t?void 0:t.filter(e=>"audio"===e.content_type).length)||0,pdf:(null==t?void 0:t.filter(e=>"pdf"===e.content_type).length)||0,other:(null==t?void 0:t.filter(e=>["image","interactive"].includes(e.content_type)).length)||0}},async getAuthors(){let{data:e}=await a.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:r}=await a.from("books").select("author").eq("user_id",e.user.id).not("author","is",null);if(r)throw r;return Array.from(new Set(null==t?void 0:t.map(e=>e.author).filter(Boolean))).sort()},async getLanguages(){let{data:e}=await a.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:r}=await a.from("books").select("language").eq("user_id",e.user.id);if(r)throw r;return Array.from(new Set(null==t?void 0:t.map(e=>e.language).filter(Boolean))).sort()},getContentTypes:()=>[{value:"text",label:"Text",icon:"\uD83D\uDCC4"},{value:"pdf",label:"PDF",icon:"\uD83D\uDCD1"},{value:"video",label:"Video",icon:"\uD83C\uDFA5"},{value:"audio",label:"Audio",icon:"\uD83C\uDFA7"},{value:"image",label:"Image",icon:"\uD83D\uDDBC️"},{value:"interactive",label:"Interactive",icon:"\uD83C\uDFAE"}]}},13027:function(e,t,r){"use strict";r.d(t,{j:function(){return i}});var a=r(44839);let n=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,s=a.W,i=(e,t)=>r=>{var a;if((null==t?void 0:t.variants)==null)return s(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:i,defaultVariants:l}=t,c=Object.keys(i).map(e=>{let t=null==r?void 0:r[e],a=null==l?void 0:l[e];if(null===t)return null;let s=n(t)||n(a);return i[e][s]}),o=r&&Object.entries(r).reduce((e,t)=>{let[r,a]=t;return void 0===a||(e[r]=a),e},{});return s(e,c,null==t?void 0:null===(a=t.compoundVariants)||void 0===a?void 0:a.reduce((e,t)=>{let{class:r,className:a,...n}=t;return Object.entries(n).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...l,...o}[t]):({...l,...o})[t]===r})?[...e,r,a]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)}},44839:function(e,t,r){"use strict";function a(){for(var e,t,r=0,a="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=function e(t){var r,a,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t){if(Array.isArray(t)){var s=t.length;for(r=0;r<s;r++)t[r]&&(a=e(t[r]))&&(n&&(n+=" "),n+=a)}else for(a in t)t[a]&&(n&&(n+=" "),n+=a)}return n}(e))&&(a&&(a+=" "),a+=t);return a}r.d(t,{W:function(){return a}})}},function(e){e.O(0,[4392,8409,2318,2971,7023,1744],function(){return e(e.s=31588)}),_N_E=e.O()}]);