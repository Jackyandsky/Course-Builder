(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[678],{31588:function(e,t,r){Promise.resolve().then(r.bind(r,24739))},78030:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var n=r(2265);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),i=e=>{let t=s(e);return t.charAt(0).toUpperCase()+t.slice(1)},l=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},o=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:u="",children:d,iconNode:h,...f}=e;return(0,n.createElement)("svg",{ref:t,...c,width:a,height:a,stroke:r,strokeWidth:i?24*Number(s)/Number(a):s,className:l("lucide",u),...!d&&!o(f)&&{"aria-hidden":"true"},...f},[...h.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),d=(e,t)=>{let r=(0,n.forwardRef)((r,s)=>{let{className:o,...c}=r;return(0,n.createElement)(u,{ref:s,iconNode:t,className:l("lucide-".concat(a(i(e))),"lucide-".concat(e),o),...c})});return r.displayName=i(e),r}},95137:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(78030).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6540:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(78030).Z)("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]])},42421:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(78030).Z)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},70518:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(78030).Z)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},87592:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(78030).Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},14392:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(78030).Z)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]])},63550:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(78030).Z)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},65607:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(78030).Z)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]])},4436:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(78030).Z)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]])},74453:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(78030).Z)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},54817:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(78030).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},6649:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(78030).Z)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},10883:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(78030).Z)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},74697:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(78030).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},16463:function(e,t,r){"use strict";var n=r(71169);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},24739:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return m}});var n=r(57437),a=r(2265),s=r(16463),i=r(95137),l=r(6540),o=r(4436),c=r(74453),u=r(6649),d=r(10883),h=r(46749),f=r(2318);function m(){let e=(0,s.useRouter)(),t=(0,s.useParams)().id,[r,m]=(0,a.useState)(null),[g,x]=(0,a.useState)(!0),[y,p]=(0,a.useState)(!1),[v,k]=(0,a.useState)(!1);(0,a.useEffect)(()=>{t&&j()},[t]);let j=async()=>{x(!0);try{let e=await h.a.getBook(t);m(e)}catch(t){console.error("Failed to load book:",t),e.push("/books")}finally{x(!1)}},b=async()=>{p(!0);try{await h.a.deleteBook(t),e.push("/books"),e.refresh()}catch(e){console.error("Failed to delete book:",e)}finally{p(!1),k(!1)}};return g?(0,n.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,n.jsx)(f.$j,{size:"lg"})}):r?(0,n.jsxs)("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)(f.zx,{variant:"ghost",size:"sm",onClick:()=>e.push("/books"),leftIcon:(0,n.jsx)(i.Z,{className:"h-4 w-4"}),className:"mb-4",children:"Back to Books"}),(0,n.jsxs)("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-6",children:[(0,n.jsxs)("div",{className:"flex items-start gap-6",children:[r.cover_image_url?(0,n.jsx)("img",{src:r.cover_image_url,alt:r.title,className:"w-40 h-56 rounded-lg object-cover shadow-lg"}):(0,n.jsx)("div",{className:"w-40 h-56 rounded-lg bg-gray-200 flex items-center justify-center",children:(0,n.jsx)(l.Z,{className:"w-16 h-16 text-gray-400"})}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:r.title}),r.author&&(0,n.jsxs)("p",{className:"text-lg text-gray-600 mt-1",children:["by ",r.author]}),(0,n.jsxs)("div",{className:"flex items-center gap-3 mt-4",children:[(0,n.jsxs)(f.Ct,{variant:r.is_public?"success":"secondary",children:[r.is_public?(0,n.jsx)(o.Z,{className:"h-4 w-4 mr-1.5"}):(0,n.jsx)(c.Z,{className:"h-4 w-4 mr-1.5"}),r.is_public?"Public":"Private"]}),r.category&&(0,n.jsx)(f.Ct,{style:{backgroundColor:"".concat(r.category.color,"20"),color:r.category.color},children:r.category.name})]})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[(0,n.jsx)(f.zx,{variant:"outline",onClick:()=>e.push("/books/".concat(t,"/edit")),leftIcon:(0,n.jsx)(u.Z,{className:"h-4 w-4"}),children:"Edit"}),(0,n.jsx)(f.zx,{variant:"danger",onClick:()=>k(!0),leftIcon:(0,n.jsx)(d.Z,{className:"h-4 w-4"}),className:"text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",children:"Delete"})]})]})]}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)(f.Zb,{children:[(0,n.jsx)(f.Zb.Header,{children:(0,n.jsx)("h2",{className:"text-lg font-semibold",children:"Description"})}),(0,n.jsx)(f.Zb.Content,{children:(0,n.jsx)("div",{className:"prose prose-sm max-w-none dark:prose-invert",children:r.description||(0,n.jsx)("p",{className:"text-gray-500 italic",children:"No description provided."})})})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,n.jsxs)(f.Zb,{children:[(0,n.jsx)(f.Zb.Header,{children:(0,n.jsx)("h2",{className:"text-lg font-semibold",children:"Details"})}),(0,n.jsx)(f.Zb.Content,{children:(0,n.jsxs)("dl",{className:"space-y-3 text-sm",children:[r.publisher&&(0,n.jsxs)("div",{children:[(0,n.jsx)("dt",{className:"font-medium text-gray-500",children:"Publisher"}),(0,n.jsx)("dd",{children:r.publisher})]}),r.publication_year&&(0,n.jsxs)("div",{children:[(0,n.jsx)("dt",{className:"font-medium text-gray-500",children:"Year"}),(0,n.jsx)("dd",{children:r.publication_year})]}),r.language&&(0,n.jsxs)("div",{children:[(0,n.jsx)("dt",{className:"font-medium text-gray-500",children:"Language"}),(0,n.jsx)("dd",{className:"uppercase",children:r.language})]}),r.content_type&&(0,n.jsxs)("div",{children:[(0,n.jsx)("dt",{className:"font-medium text-gray-500",children:"Content Type"}),(0,n.jsx)("dd",{className:"capitalize",children:r.content_type})]})]})})]}),r.tags&&r.tags.length>0&&(0,n.jsxs)(f.Zb,{children:[(0,n.jsx)(f.Zb.Header,{children:(0,n.jsx)("h2",{className:"text-lg font-semibold",children:"Tags"})}),(0,n.jsx)(f.Zb.Content,{children:(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:r.tags.map(e=>(0,n.jsx)(f.Ct,{children:e},e))})})]})]})]}),(0,n.jsxs)(f.u_,{isOpen:v,onClose:()=>k(!1),title:"Delete Book",className:"max-w-md",children:[(0,n.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:['Are you sure you want to delete "',r.title,'"? This action cannot be undone.']}),(0,n.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,n.jsx)(f.zx,{variant:"outline",onClick:()=>k(!1),children:"Cancel"}),(0,n.jsx)(f.zx,{variant:"danger",onClick:b,loading:y,children:"Delete Book"})]})]})]}):null}},46749:function(e,t,r){"use strict";r.d(t,{a:function(){return a}});let n=(0,r(64392).createClientComponentClient)(),a={async getBooks(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.from("books").select("\n        *,\n        category:categories(id, name, color, icon)\n      ").order("created_at",{ascending:!1});e.search&&(t=t.or("title.ilike.%".concat(e.search,"%,author.ilike.%").concat(e.search,"%,description.ilike.%").concat(e.search,"%"))),e.author&&(t=t.ilike("author","%".concat(e.author,"%"))),e.categoryId&&(t=t.eq("category_id",e.categoryId)),e.contentType&&(t=t.eq("content_type",e.contentType)),e.language&&(t=t.eq("language",e.language)),e.publicationYear&&(t=t.eq("publication_year",e.publicationYear)),void 0!==e.isPublic&&(t=t.eq("is_public",e.isPublic)),e.tags&&e.tags.length>0&&(t=t.contains("tags",e.tags));let{data:r,error:a}=await t;if(a)throw a;return r},async getBook(e){let{data:t,error:r}=await n.from("books").select("\n        *,\n        category:categories(id, name, color, icon),\n        course_books(\n          id,\n          course_id,\n          is_required,\n          notes,\n          position,\n          course:courses(id, title, status)\n        )\n      ").eq("id",e).single();if(r)throw r;return t},async createBook(e){let{data:t}=await n.auth.getUser();if(!t.user)throw Error("User not authenticated");let r={...e,language:e.language||"en",is_public:e.is_public||!1,user_id:t.user.id},{data:a,error:s}=await n.from("books").insert(r).select().single();if(s)throw s;return a},async updateBook(e){let{id:t,...r}=e,{data:a,error:s}=await n.from("books").update({...r,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(s)throw s;return a},async deleteBook(e){let{error:t}=await n.from("books").delete().eq("id",e);if(t)throw t},async getBookStats(){let{data:e}=await n.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:r}=await n.from("books").select("content_type",{count:"exact"}).eq("user_id",e.user.id);if(r)throw r;return{total:(null==t?void 0:t.length)||0,text:(null==t?void 0:t.filter(e=>"text"===e.content_type).length)||0,video:(null==t?void 0:t.filter(e=>"video"===e.content_type).length)||0,audio:(null==t?void 0:t.filter(e=>"audio"===e.content_type).length)||0,pdf:(null==t?void 0:t.filter(e=>"pdf"===e.content_type).length)||0,other:(null==t?void 0:t.filter(e=>["image","interactive"].includes(e.content_type)).length)||0}},async getAuthors(){let{data:e}=await n.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:r}=await n.from("books").select("author").eq("user_id",e.user.id).not("author","is",null);if(r)throw r;return Array.from(new Set(null==t?void 0:t.map(e=>e.author).filter(Boolean))).sort()},async getLanguages(){let{data:e}=await n.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:r}=await n.from("books").select("language").eq("user_id",e.user.id);if(r)throw r;return Array.from(new Set(null==t?void 0:t.map(e=>e.language).filter(Boolean))).sort()},getContentTypes:()=>[{value:"text",label:"Text",icon:"\uD83D\uDCC4"},{value:"pdf",label:"PDF",icon:"\uD83D\uDCD1"},{value:"video",label:"Video",icon:"\uD83C\uDFA5"},{value:"audio",label:"Audio",icon:"\uD83C\uDFA7"},{value:"image",label:"Image",icon:"\uD83D\uDDBCï¸"},{value:"interactive",label:"Interactive",icon:"\uD83C\uDFAE"}]}},13027:function(e,t,r){"use strict";r.d(t,{j:function(){return i}});var n=r(44839);let a=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,s=n.W,i=(e,t)=>r=>{var n;if((null==t?void 0:t.variants)==null)return s(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:i,defaultVariants:l}=t,o=Object.keys(i).map(e=>{let t=null==r?void 0:r[e],n=null==l?void 0:l[e];if(null===t)return null;let s=a(t)||a(n);return i[e][s]}),c=r&&Object.entries(r).reduce((e,t)=>{let[r,n]=t;return void 0===n||(e[r]=n),e},{});return s(e,o,null==t?void 0:null===(n=t.compoundVariants)||void 0===n?void 0:n.reduce((e,t)=>{let{class:r,className:n,...a}=t;return Object.entries(a).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...l,...c}[t]):({...l,...c})[t]===r})?[...e,r,n]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)}},44839:function(e,t,r){"use strict";function n(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=function e(t){var r,n,a="";if("string"==typeof t||"number"==typeof t)a+=t;else if("object"==typeof t){if(Array.isArray(t)){var s=t.length;for(r=0;r<s;r++)t[r]&&(n=e(t[r]))&&(a&&(a+=" "),a+=n)}else for(n in t)t[n]&&(a&&(a+=" "),a+=n)}return a}(e))&&(n&&(n+=" "),n+=t);return n}r.d(t,{W:function(){return n}})}},function(e){e.O(0,[4392,8409,2318,2971,7023,1744],function(){return e(e.s=31588)}),_N_E=e.O()}]);