"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5685],{78030:function(e,t,a){a.d(t,{Z:function(){return d}});var r=a(2265);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),o=e=>{let t=l(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()},s=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:n=24,strokeWidth:l=2,absoluteStrokeWidth:o,className:u="",children:d,iconNode:h,...g}=e;return(0,r.createElement)("svg",{ref:t,...c,width:n,height:n,stroke:a,strokeWidth:o?24*Number(l)/Number(n):l,className:i("lucide",u),...!d&&!s(g)&&{"aria-hidden":"true"},...g},[...h.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(d)?d:[d]])}),d=(e,t)=>{let a=(0,r.forwardRef)((a,l)=>{let{className:s,...c}=a;return(0,r.createElement)(u,{ref:l,iconNode:t,className:i("lucide-".concat(n(o(e))),"lucide-".concat(e),s),...c})});return a.displayName=o(e),a}},95137:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(78030).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},42421:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(78030).Z)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},70518:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(78030).Z)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},87592:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(78030).Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},14392:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(78030).Z)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]])},63550:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(78030).Z)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},65607:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(78030).Z)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]])},92513:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(78030).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},59061:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(78030).Z)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},54817:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(78030).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},74697:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(78030).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},16463:function(e,t,a){var r=a(71169);a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},81871:function(e,t,a){a.d(t,{t:function(){return g}});var r=a(57437),n=a(2265),l=a(16463),o=a(95137),i=a(92513),s=a(74697),c=a(59061),u=a(46749),d=a(60287),h=a(2318);function g(e){let{initialData:t}=e,a=(0,l.useRouter)(),g=!!t,[p,m]=(0,n.useState)(!1),[y,f]=(0,n.useState)([]),[v,b]=(0,n.useState)(!1),[x,k]=(0,n.useState)(""),[w,j]=(0,n.useState)("#6b7280"),[C,_]=(0,n.useState)({title:(null==t?void 0:t.title)||"",author:(null==t?void 0:t.author)||"",description:(null==t?void 0:t.description)||"",category_id:(null==t?void 0:t.category_id)||"",content_type:(null==t?void 0:t.content_type)||"text",language:(null==t?void 0:t.language)||"en",tags:(null==t?void 0:t.tags)||[],cover_image_url:(null==t?void 0:t.cover_image_url)||"",publication_year:(null==t?void 0:t.publication_year)||"",is_public:(null==t?void 0:t.is_public)||!1}),[N,Z]=(0,n.useState)({}),[I,D]=(0,n.useState)("");(0,n.useEffect)(()=>{q()},[]);let q=async()=>{try{let e=await d.G.getCategories({type:"book"});f(e)}catch(e){console.error("Failed to load categories:",e)}},A=()=>{let e={};return C.title.trim()||(e.title="Title is required"),C.publication_year&&isNaN(Number(C.publication_year))&&(e.publication_year="Publication year must be a number"),Z(e),0===Object.keys(e).length},B=async e=>{if(e.preventDefault(),A()){m(!0);try{let e={...C,publication_year:C.publication_year?Number(C.publication_year):void 0};g?await u.a.updateBook({id:t.id,...e}):await u.a.createBook(e),a.push("/books"),a.refresh()}catch(e){console.error("Failed to save book:",e),Z({submit:e.message||"Failed to save book. Please try again."})}finally{m(!1)}}},S=()=>{I.trim()&&!C.tags.includes(I.trim())&&(_({...C,tags:[...C.tags,I.trim()]}),D(""))},z=e=>{_({...C,tags:C.tags.filter(t=>t!==e)})},E=async()=>{if(x.trim())try{let e=await d.G.createCategory({name:x,type:"book",color:w});b(!1),k(""),await q(),_({...C,category_id:e.id})}catch(e){console.error("Failed to create book category:",e)}};return(0,r.jsxs)("form",{onSubmit:B,className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)(h.zx,{type:"button",variant:"ghost",size:"sm",onClick:()=>a.back(),leftIcon:(0,r.jsx)(o.Z,{className:"h-4 w-4"}),className:"mb-4",children:"Back"}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:g?"Edit Book":"Create New Book"})]}),N.submit&&(0,r.jsx)("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 rounded-lg",children:N.submit}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(h.Zb,{children:[(0,r.jsx)(h.Zb.Header,{children:(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Basic Information"})}),(0,r.jsxs)(h.Zb.Content,{className:"space-y-4",children:[(0,r.jsx)(h.II,{label:"Book Title",value:C.title,onChange:e=>_({...C,title:e.target.value}),error:N.title,placeholder:"Enter book title",required:!0}),(0,r.jsx)(h.II,{label:"Author",value:C.author,onChange:e=>_({...C,author:e.target.value}),placeholder:"Enter author's name"}),(0,r.jsx)(h.gx,{label:"Description",value:C.description,onChange:e=>_({...C,description:e.target.value}),placeholder:"Detailed book description",rows:4}),(0,r.jsx)(h.II,{label:"Cover Image URL",type:"url",value:C.cover_image_url,onChange:e=>_({...C,cover_image_url:e.target.value}),placeholder:"https://example.com/image.jpg"})]})]}),(0,r.jsxs)(h.Zb,{children:[(0,r.jsx)(h.Zb.Header,{children:(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Details & Categorization"})}),(0,r.jsxs)(h.Zb.Content,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"md:col-span-1",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(h.Ph,{className:"flex-grow",value:C.category_id,onChange:e=>_({...C,category_id:e.target.value}),options:[{value:"",label:"Select category"},...y.map(e=>({value:e.id,label:e.name}))]}),(0,r.jsx)(h.zx,{type:"button",variant:"outline",size:"md",onClick:()=>b(!0),className:"flex-shrink-0 !h-10",children:(0,r.jsx)(i.Z,{className:"h-4 w-4"})})]})]}),(0,r.jsx)(h.II,{label:"Publication Year",type:"number",value:C.publication_year,onChange:e=>_({...C,publication_year:e.target.value}),error:N.publication_year,placeholder:"e.g., 2023"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(h.Ph,{label:"Content Type",value:C.content_type,onChange:e=>_({...C,content_type:e.target.value}),options:u.a.getContentTypes()}),(0,r.jsx)(h.II,{label:"Language",value:C.language,onChange:e=>_({...C,language:e.target.value}),placeholder:"e.g., en"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 pt-2",children:[(0,r.jsx)("input",{type:"checkbox",id:"is_public",checked:C.is_public,onChange:e=>_({...C,is_public:e.target.checked}),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"is_public",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Make this book publicly accessible"})]})]})]}),(0,r.jsxs)(h.Zb,{children:[(0,r.jsx)(h.Zb.Header,{children:(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Tags"})}),(0,r.jsxs)(h.Zb.Content,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(h.II,{value:I,onChange:e=>D(e.target.value),placeholder:"Add a tag",onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),S())}}),(0,r.jsx)(h.zx,{type:"button",onClick:S,leftIcon:(0,r.jsx)(i.Z,{className:"h-4 w-4"}),children:"Add"})]}),C.tags.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:C.tags.map(e=>(0,r.jsxs)(h.Ct,{variant:"secondary",className:"px-3 py-1",children:[e,(0,r.jsx)("button",{type:"button",onClick:()=>z(e),className:"ml-2 hover:text-red-500",children:(0,r.jsx)(s.Z,{className:"h-3 w-3"})})]},e))})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,r.jsx)(h.zx,{type:"button",variant:"outline",onClick:()=>a.push("/books"),children:"Cancel"}),(0,r.jsx)(h.zx,{type:"submit",loading:p,leftIcon:(0,r.jsx)(c.Z,{className:"h-4 w-4"}),children:g?"Update Book":"Create Book"})]})]}),(0,r.jsxs)(h.u_,{isOpen:v,onClose:()=>b(!1),title:"Create New Book Category",size:"sm",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(h.II,{label:"Category Name",value:x,onChange:e=>k(e.target.value),placeholder:"e.g., Fiction, Science, etc.",required:!0}),(0,r.jsx)(h.II,{label:"Category Color",type:"color",value:w,onChange:e=>j(e.target.value),className:"h-10"})]}),(0,r.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,r.jsx)(h.zx,{variant:"ghost",onClick:()=>b(!1),children:"Cancel"}),(0,r.jsx)(h.zx,{onClick:E,children:"Create Category"})]})]})]})}},46749:function(e,t,a){a.d(t,{a:function(){return n}});let r=(0,a(64392).createClientComponentClient)(),n={async getBooks(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=r.from("books").select("\n        *,\n        category:categories(id, name, color, icon)\n      ").order("created_at",{ascending:!1});e.search&&(t=t.or("title.ilike.%".concat(e.search,"%,author.ilike.%").concat(e.search,"%,description.ilike.%").concat(e.search,"%"))),e.author&&(t=t.ilike("author","%".concat(e.author,"%"))),e.categoryId&&(t=t.eq("category_id",e.categoryId)),e.contentType&&(t=t.eq("content_type",e.contentType)),e.language&&(t=t.eq("language",e.language)),e.publicationYear&&(t=t.eq("publication_year",e.publicationYear)),void 0!==e.isPublic&&(t=t.eq("is_public",e.isPublic)),e.tags&&e.tags.length>0&&(t=t.contains("tags",e.tags));let{data:a,error:n}=await t;if(n)throw n;return a},async getBook(e){let{data:t,error:a}=await r.from("books").select("\n        *,\n        category:categories(id, name, color, icon),\n        course_books(\n          id,\n          course_id,\n          is_required,\n          notes,\n          position,\n          course:courses(id, title, status)\n        )\n      ").eq("id",e).single();if(a)throw a;return t},async createBook(e){let{data:t}=await r.auth.getUser();if(!t.user)throw Error("User not authenticated");let a={...e,language:e.language||"en",is_public:e.is_public||!1,user_id:t.user.id},{data:n,error:l}=await r.from("books").insert(a).select().single();if(l)throw l;return n},async updateBook(e){let{id:t,...a}=e,{data:n,error:l}=await r.from("books").update({...a,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(l)throw l;return n},async deleteBook(e){let{error:t}=await r.from("books").delete().eq("id",e);if(t)throw t},async getBookStats(){let{data:e}=await r.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:a}=await r.from("books").select("content_type",{count:"exact"}).eq("user_id",e.user.id);if(a)throw a;return{total:(null==t?void 0:t.length)||0,text:(null==t?void 0:t.filter(e=>"text"===e.content_type).length)||0,video:(null==t?void 0:t.filter(e=>"video"===e.content_type).length)||0,audio:(null==t?void 0:t.filter(e=>"audio"===e.content_type).length)||0,pdf:(null==t?void 0:t.filter(e=>"pdf"===e.content_type).length)||0,other:(null==t?void 0:t.filter(e=>["image","interactive"].includes(e.content_type)).length)||0}},async getAuthors(){let{data:e}=await r.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:a}=await r.from("books").select("author").eq("user_id",e.user.id).not("author","is",null);if(a)throw a;return Array.from(new Set(null==t?void 0:t.map(e=>e.author).filter(Boolean))).sort()},async getLanguages(){let{data:e}=await r.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:a}=await r.from("books").select("language").eq("user_id",e.user.id);if(a)throw a;return Array.from(new Set(null==t?void 0:t.map(e=>e.language).filter(Boolean))).sort()},getContentTypes:()=>[{value:"text",label:"Text",icon:"\uD83D\uDCC4"},{value:"pdf",label:"PDF",icon:"\uD83D\uDCD1"},{value:"video",label:"Video",icon:"\uD83C\uDFA5"},{value:"audio",label:"Audio",icon:"\uD83C\uDFA7"},{value:"image",label:"Image",icon:"\uD83D\uDDBCï¸"},{value:"interactive",label:"Interactive",icon:"\uD83C\uDFAE"}]}},60287:function(e,t,a){a.d(t,{G:function(){return n}});let r=(0,a(64392).createClientComponentClient)(),n={async getCategories(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=r.from("categories").select("*").order("name",{ascending:!0});e.type&&(t=t.eq("type",e.type)),void 0!==e.parentId&&(t=t.eq("parent_id",e.parentId)),e.search&&(t=t.ilike("name","%".concat(e.search,"%")));let{data:a,error:n}=await t;if(n)throw n;return a},async getCategory(e){let{data:t,error:a}=await r.from("categories").select("*").eq("id",e).single();if(a)throw a;return t},async createCategory(e){let{data:t}=await r.auth.getUser();if(!t.user)throw Error("User not authenticated");let{data:a,error:n}=await r.from("categories").insert({...e,user_id:t.user.id}).select().single();if(n)throw n;return a},async updateCategory(e){let{id:t,...a}=e,{data:n,error:l}=await r.from("categories").update({...a,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(l)throw l;return n},async deleteCategory(e){let{error:t}=await r.from("categories").delete().eq("id",e);if(t)throw t},getCategoryTypes:()=>[{value:"course",label:"Course"},{value:"book",label:"Book"},{value:"vocabulary",label:"Vocabulary"},{value:"objective",label:"Objective"},{value:"method",label:"Method"},{value:"task",label:"Task"}]}},13027:function(e,t,a){a.d(t,{j:function(){return o}});var r=a(44839);let n=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,l=r.W,o=(e,t)=>a=>{var r;if((null==t?void 0:t.variants)==null)return l(e,null==a?void 0:a.class,null==a?void 0:a.className);let{variants:o,defaultVariants:i}=t,s=Object.keys(o).map(e=>{let t=null==a?void 0:a[e],r=null==i?void 0:i[e];if(null===t)return null;let l=n(t)||n(r);return o[e][l]}),c=a&&Object.entries(a).reduce((e,t)=>{let[a,r]=t;return void 0===r||(e[a]=r),e},{});return l(e,s,null==t?void 0:null===(r=t.compoundVariants)||void 0===r?void 0:r.reduce((e,t)=>{let{class:a,className:r,...n}=t;return Object.entries(n).every(e=>{let[t,a]=e;return Array.isArray(a)?a.includes({...i,...c}[t]):({...i,...c})[t]===a})?[...e,a,r]:e},[]),null==a?void 0:a.class,null==a?void 0:a.className)}},44839:function(e,t,a){a.d(t,{W:function(){return r}});function r(){for(var e,t,a=0,r="",n=arguments.length;a<n;a++)(e=arguments[a])&&(t=function e(t){var a,r,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t){if(Array.isArray(t)){var l=t.length;for(a=0;a<l;a++)t[a]&&(r=e(t[a]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r)}return n}(e))&&(r&&(r+=" "),r+=t);return r}}}]);