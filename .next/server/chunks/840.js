exports.id=840,exports.ids=[840],exports.modules={93853:(e,t,a)=>{Promise.resolve().then(a.bind(a,52353))},62881:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c});var s=a(17577);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),i=e=>{let t=l(e);return t.charAt(0).toUpperCase()+t.slice(1)},n=(...e)=>e.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim(),u=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,s.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:l="",children:i,iconNode:o,...c},h)=>(0,s.createElement)("svg",{ref:h,...d,width:t,height:t,stroke:e,strokeWidth:r?24*Number(a)/Number(t):a,className:n("lucide",l),...!i&&!u(c)&&{"aria-hidden":"true"},...c},[...o.map(([e,t])=>(0,s.createElement)(e,t)),...Array.isArray(i)?i:[i]])),c=(e,t)=>{let a=(0,s.forwardRef)(({className:a,...l},u)=>(0,s.createElement)(o,{ref:u,iconNode:t,className:n(`lucide-${r(i(e))}`,`lucide-${e}`,a),...l}));return a.displayName=i(e),a}},31215:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(62881).Z)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},52353:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var s=a(10326),r=a(62760),l=a(80341);function i({children:e}){return s.jsx(l.AuthGuard,{children:s.jsx(r.DashboardLayout,{children:e})})}},23629:(e,t,a)=>{"use strict";a.d(t,{c:()=>p});var s=a(10326),r=a(17577),l=a(35047),i=a(99837),n=a(89175),u=a(36181),d=a(2102),o=a(94001),c=a(21754);a(64727);var h=a(31215);let m=[{value:"none",label:"No Recurrence (One-time)"},{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"biweekly",label:"Bi-weekly"},{value:"monthly",label:"Monthly"}],g=[{value:"monday",label:"Monday"},{value:"tuesday",label:"Tuesday"},{value:"wednesday",label:"Wednesday"},{value:"thursday",label:"Thursday"},{value:"friday",label:"Friday"},{value:"saturday",label:"Saturday"},{value:"sunday",label:"Sunday"}],_=[{value:"UTC",label:"UTC"},{value:"America/New_York",label:"Eastern Time (US)"},{value:"America/Chicago",label:"Central Time (US)"},{value:"America/Denver",label:"Mountain Time (US)"},{value:"America/Los_Angeles",label:"Pacific Time (US)"},{value:"Europe/London",label:"London"},{value:"Europe/Paris",label:"Paris"},{value:"Asia/Tokyo",label:"Tokyo"},{value:"Asia/Shanghai",label:"Shanghai"},{value:"Australia/Sydney",label:"Sydney"}];function p({schedule:e,onSuccess:t}){let a=(0,l.useRouter)(),{user:p}=(0,o.a)(),y=!!e,[v,f]=(0,r.useState)(!1),[b,w]=(0,r.useState)([]),[x,S]=(0,r.useState)({course_id:e?.course_id||"",name:e?.name||"",description:e?.description||"",start_date:e?.start_date||new Date().toISOString().split("T")[0],end_date:e?.end_date||"",recurrence_type:e?.recurrence_type||"weekly",recurrence_days:e?.recurrence_days||["monday","wednesday","friday"],default_start_time:e?.default_start_time||"09:00",default_duration_minutes:e?.default_duration_minutes||60,timezone:e?.timezone||Intl.DateTimeFormat().resolvedOptions().timeZone||"UTC",location:e?.location||"",max_students:e?.max_students||20,is_active:e?.is_active!==!1}),[j,C]=(0,r.useState)({}),k=()=>{let e={};return x.name.trim()||(e.name="Schedule name is required"),x.course_id||(e.course_id="A course must be selected"),x.start_date||(e.start_date="Start date is required"),C(e),0===Object.keys(e).length},D=async s=>{if(s.preventDefault(),k()&&p){f(!0);try{let s={...x,user_id:p.id,max_students:null===x.max_students?void 0:x.max_students,default_duration_minutes:x.default_duration_minutes};y?await c.y.updateSchedule(e.id,s):await c.y.createSchedule(s),t?t():(a.push("/schedules"),a.refresh())}catch(e){console.error("Failed to save schedule:",e),C({submit:e.message||"Failed to save schedule. Please try again."})}finally{f(!1)}}},N=e=>{S(t=>({...t,recurrence_days:t.recurrence_days.includes(e)?t.recurrence_days.filter(t=>t!==e):[...t.recurrence_days,e]}))};return(0,s.jsxs)("form",{onSubmit:D,className:"space-y-6",children:[j.submit&&s.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 rounded-lg",children:j.submit}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsx("div",{className:"col-span-2",children:s.jsx(d.P,{label:"Course",value:x.course_id,onChange:e=>S({...x,course_id:e.target.value}),required:!0,error:j.course_id,options:b.map(e=>({value:e.id,label:e.title})),placeholder:"Select a course..."})}),s.jsx("div",{className:"col-span-2",children:s.jsx(n.I,{label:"Schedule Name",value:x.name,onChange:e=>S({...x,name:e.target.value}),placeholder:"e.g., Morning Classes, Evening Sessions",required:!0,error:j.name})}),s.jsx("div",{className:"col-span-2",children:s.jsx(u.g,{label:"Description",value:x.description||"",onChange:e=>S({...x,description:e.target.value}),placeholder:"Describe this schedule...",rows:3})}),s.jsx("div",{children:s.jsx(n.I,{type:"date",label:"Start Date",value:x.start_date,onChange:e=>S({...x,start_date:e.target.value}),required:!0,error:j.start_date})}),s.jsx("div",{children:s.jsx(n.I,{type:"date",label:"End Date (Optional)",value:x.end_date,onChange:e=>S({...x,end_date:e.target.value}),helperText:"Leave empty for ongoing schedule"})}),s.jsx("div",{children:s.jsx(d.P,{label:"Recurrence",value:x.recurrence_type,onChange:e=>S({...x,recurrence_type:e.target.value}),options:m})}),"none"!==x.recurrence_type&&(0,s.jsxs)("div",{className:"col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class Days"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:g.map(e=>s.jsx("button",{type:"button",onClick:()=>N(e.value),className:`px-4 py-2 rounded-md transition-colors ${x.recurrence_days?.includes(e.value)?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:e.label},e.value))})]}),s.jsx("div",{children:s.jsx(n.I,{type:"time",label:"Default Start Time",value:x.default_start_time,onChange:e=>S({...x,default_start_time:e.target.value}),required:!0})}),s.jsx("div",{children:s.jsx(n.I,{type:"number",label:"Duration (minutes)",value:x.default_duration_minutes,onChange:e=>S({...x,default_duration_minutes:parseInt(e.target.value)}),min:"15",max:"480",required:!0})}),s.jsx("div",{children:s.jsx(d.P,{label:"Timezone",value:x.timezone,onChange:e=>S({...x,timezone:e.target.value}),options:_})}),s.jsx("div",{children:s.jsx(n.I,{label:"Location",value:x.location,onChange:e=>S({...x,location:e.target.value}),placeholder:"e.g., Room 101, Online, etc."})}),s.jsx("div",{children:s.jsx(n.I,{type:"number",label:"Maximum Students",value:x.max_students,onChange:e=>S({...x,max_students:parseInt(e.target.value)}),min:"1",max:"1000"})}),s.jsx("div",{className:"flex items-center",children:(0,s.jsxs)("label",{className:"flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:x.is_active,onChange:e=>S({...x,is_active:e.target.checked}),className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Active Schedule"})]})})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4 mt-6",children:[s.jsx(i.z,{type:"button",variant:"outline",onClick:()=>a.push("/schedules"),children:"Cancel"}),s.jsx(i.z,{type:"submit",loading:v,leftIcon:s.jsx(h.Z,{className:"h-4 w-4"}),children:y?"Update Schedule":"Create Schedule"})]})]})}},21754:(e,t,a)=>{"use strict";a.d(t,{y:()=>l});var s=a(59813);class r{async getSchedules(e){let t=this.supabase.from("schedules").select(`
        *,
        course:courses(id, title, description),
        lessons(count)
      `).order("created_at",{ascending:!1});e?.course_id&&(t=t.eq("course_id",e.course_id)),e?.is_active!==void 0&&(t=t.eq("is_active",e.is_active)),e?.user_id&&(t=t.eq("user_id",e.user_id));let{data:a,error:s}=await t;if(s)throw s;return a}async getSchedule(e){let{data:t,error:a}=await this.supabase.from("schedules").select(`
        *,
        course:courses(*),
        lessons(
          *,
          objectives:lesson_objectives(
            *,
            objective:objectives(*)
          ),
          methods:lesson_methods(
            *,
            method:methods(*)
          ),
          tasks:lesson_tasks(
            *,
            task:tasks(*)
          )
        )
      `).eq("id",e).single();if(a)throw a;return t}async createSchedule(e){let{data:t,error:a}=await this.supabase.from("schedules").insert(e).select().single();if(a)throw a;return"none"!==e.recurrence_type&&t&&await this.generateRecurringLessons(t.id,e),t}async updateSchedule(e,t){let{data:a,error:s}=await this.supabase.from("schedules").update(t).eq("id",e).select().single();if(s)throw s;return a}async deleteSchedule(e){let{error:t}=await this.supabase.from("schedules").delete().eq("id",e);if(t)throw t}async getLessons(e){let t=this.supabase.from("lessons").select(`
        *,
        schedule:schedules(
          *,
          course:courses(id, title)
        ),
        attendance(count)
      `).order("date",{ascending:!0}).order("start_time",{ascending:!0});e?.schedule_id&&(t=t.eq("schedule_id",e.schedule_id)),e?.status&&(t=t.eq("status",e.status)),e?.date_from&&(t=t.gte("date",e.date_from)),e?.date_to&&(t=t.lte("date",e.date_to)),e?.user_id&&(t=t.eq("user_id",e.user_id));let{data:a,error:s}=await t;if(s)throw s;return a}async getLesson(e){let{data:t,error:a}=await this.supabase.from("lessons").select(`
        *,
        schedule:schedules(
          *,
          course:courses(*)
        ),
        attendance(*),
        objectives:lesson_objectives(
          *,
          objective:objectives(*)
        ),
        methods:lesson_methods(
          *,
          method:methods(*)
        ),
        tasks:lesson_tasks(
          *,
          task:tasks(*)
        )
      `).eq("id",e).single();if(a)throw a;return t}async createLesson(e){let{data:t,error:a}=await this.supabase.from("lessons").insert(e).select().single();if(a)throw a;return t}async updateLesson(e,t){let{data:a,error:s}=await this.supabase.from("lessons").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw s;return a}async deleteLesson(e){let{error:t}=await this.supabase.from("lessons").delete().eq("id",e);if(t)throw t}async getAttendance(e){let{data:t,error:a}=await this.supabase.from("attendance").select("*").eq("lesson_id",e).order("student_name");if(a)throw a;return t}async markAttendance(e){let{data:t,error:a}=await this.supabase.from("attendance").upsert({...e,marked_at:new Date().toISOString()}).select().single();if(a)throw a;return t}async bulkMarkAttendance(e,t){let a=t.map(t=>({...t,lesson_id:e,marked_at:new Date().toISOString()})),{data:s,error:r}=await this.supabase.from("attendance").upsert(a).select();if(r)throw r;return s}async generateRecurringLessons(e,t){let a=[],s=new Date(t.start_date),r=new Date(t.end_date?t.end_date:s);r.setMonth(r.getMonth()+3);let l=new Date(s),i=1;for(;l<=r;){if(this.shouldCreateLesson(l,t)){let[s,r]=t.default_start_time.split(":").map(Number),n=new Date(l);n.setHours(s,r,0,0);let u=new Date(n);u.setMinutes(u.getMinutes()+t.default_duration_minutes),a.push({schedule_id:e,course_id:t.course_id,title:`${t.name} - Lesson ${i}`,date:l.toISOString().split("T")[0],start_time:n.toTimeString().slice(0,5),end_time:u.toTimeString().slice(0,5),duration_minutes:t.default_duration_minutes,location:t.location,status:"scheduled",user_id:t.user_id}),i++}l=this.getNextLessonDate(l,t)}if(a.length>0){let{error:e}=await this.supabase.from("lessons").insert(a);if(e)throw e}}shouldCreateLesson(e,t){if("none"===t.recurrence_type)return!0;let a=e.toLocaleDateString("en-US",{weekday:"long"}).toLowerCase();return!t.recurrence_days||!(t.recurrence_days.length>0)||t.recurrence_days.includes(a)}getNextLessonDate(e,t){let a=new Date(e);return a.setDate(a.getDate()+1),a}transformToCalendarEvents(e){return e.map(e=>{let t=new Date(`${e.date}T${e.start_time}`),a=new Date(`${e.date}T${e.end_time}`);return{id:e.id,title:e.title,start:t,end:a,resource:{lesson:e,schedule:e.schedule},className:this.getLessonClassName(e.status)}})}getLessonClassName(e){switch(e){case"completed":return"bg-green-100 border-green-300 text-green-800";case"cancelled":return"bg-red-100 border-red-300 text-red-800";case"draft":return"bg-gray-100 border-gray-300 text-gray-800";default:return"bg-blue-100 border-blue-300 text-blue-800"}}async getScheduleStats(e){let{data:t,error:a}=await this.supabase.from("lessons").select("status, attendance(status)").eq("schedule_id",e);if(a)throw a;let s={total_lessons:t?.length||0,completed_lessons:t?.filter(e=>"completed"===e.status).length||0,cancelled_lessons:t?.filter(e=>"cancelled"===e.status).length||0,scheduled_lessons:t?.filter(e=>"scheduled"===e.status).length||0,attendance_rate:0},r=t?.flatMap(e=>e.attendance||[])||[],l=r.filter(e=>"present"===e.status).length;return r.length>0&&(s.attendance_rate=Math.round(l/r.length*100)),s}constructor(){this.supabase=(0,s.createClientComponentClient)()}}let l=new r},64727:(e,t,a)=>{"use strict";a.d(t,{J:()=>r});let s=(0,a(59813).createClientComponentClient)(),r={async getCourses(e={}){let t=s.from("courses").select(`
        *,
        category:categories(id, name, color, icon)
      `).order("created_at",{ascending:!1});e.status&&(t=t.eq("status",e.status)),e.difficulty&&(t=t.eq("difficulty",e.difficulty)),e.categoryId&&(t=t.eq("category_id",e.categoryId)),void 0!==e.isPublic&&(t=t.eq("is_public",e.isPublic)),e.search&&(t=t.or(`title.ilike.%${e.search}%,description.ilike.%${e.search}%`)),e.tags&&e.tags.length>0&&(t=t.contains("tags",e.tags));let{data:a,error:r}=await t;if(r)throw r;return a},async getCourse(e){let{data:t,error:a}=await s.from("courses").select(`
        *,
        category:categories(id, name, color, icon),
        course_books(
          id,
          book_id,
          is_required,
          notes,
          position,
          book:books(id, title, author, cover_image_url)
        ),
        course_vocabulary_groups(
          id,
          vocabulary_group_id,
          position,
          vocabulary_group:vocabulary_groups(id, name, language, difficulty)
        )
      `).eq("id",e).single();if(a)throw a;return t},async createCourse(e){let{data:t}=await s.auth.getUser();if(!t.user)throw Error("User not authenticated");let{data:a,error:r}=await s.from("courses").insert({...e,user_id:t.user.id,status:e.status||"draft",difficulty:e.difficulty||"beginner",is_public:e.is_public||!1}).select().single();if(r)throw r;return a},async updateCourse({id:e,...t}){let{data:a,error:r}=await s.from("courses").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(r)throw r;return a},async deleteCourse(e){let{error:t}=await s.from("courses").delete().eq("id",e);if(t)throw t},async publishCourse(e){let{data:t,error:a}=await s.from("courses").update({status:"published",published_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",e).select().single();if(a)throw a;return t},async archiveCourse(e){let{data:t,error:a}=await s.from("courses").update({status:"archived",updated_at:new Date().toISOString()}).eq("id",e).select().single();if(a)throw a;return t},async getCourseStats(){let{data:e}=await s.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:a}=await s.from("courses").select("status",{count:"exact"}).eq("user_id",e.user.id);if(a)throw a;return{total:t?.length||0,draft:t?.filter(e=>"draft"===e.status).length||0,published:t?.filter(e=>"published"===e.status).length||0,archived:t?.filter(e=>"archived"===e.status).length||0}}}},15206:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>i,__esModule:()=>l,default:()=>n});var s=a(68570);let r=(0,s.createProxy)(String.raw`D:\dev\cursor\course builder\src\app\schedules\layout.tsx`),{__esModule:l,$$typeof:i}=r;r.default;let n=(0,s.createProxy)(String.raw`D:\dev\cursor\course builder\src\app\schedules\layout.tsx#default`)},79360:(e,t,a)=>{"use strict";a.d(t,{j:()=>i});var s=a(41135);let r=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,l=s.W,i=(e,t)=>a=>{var s;if((null==t?void 0:t.variants)==null)return l(e,null==a?void 0:a.class,null==a?void 0:a.className);let{variants:i,defaultVariants:n}=t,u=Object.keys(i).map(e=>{let t=null==a?void 0:a[e],s=null==n?void 0:n[e];if(null===t)return null;let l=r(t)||r(s);return i[e][l]}),d=a&&Object.entries(a).reduce((e,t)=>{let[a,s]=t;return void 0===s||(e[a]=s),e},{});return l(e,u,null==t?void 0:null===(s=t.compoundVariants)||void 0===s?void 0:s.reduce((e,t)=>{let{class:a,className:s,...r}=t;return Object.entries(r).every(e=>{let[t,a]=e;return Array.isArray(a)?a.includes({...n,...d}[t]):({...n,...d})[t]===a})?[...e,a,s]:e},[]),null==a?void 0:a.class,null==a?void 0:a.className)}}};