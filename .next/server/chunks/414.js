"use strict";exports.id=414,exports.ids=[414],exports.modules={31414:(e,t,s)=>{s.d(t,{$D:()=>_,jR:()=>H,wd:()=>C,js:()=>Z});var a=s(10326),r=s(17577),i=s(99837),o=s(28676),l=s(88543),n=s(94585),c=s(36792),d=s(2777);class u{async addBookToCourse(e,t,s){let{data:a,error:r}=await this.supabase.from("course_books").insert({course_id:e,book_id:t,is_required:s?.isRequired??!1,notes:s?.notes,position:s?.position??0}).select().single();if(r)throw r;return a}async removeBookFromCourse(e,t){let{error:s}=await this.supabase.from("course_books").delete().match({course_id:e,book_id:t});if(s)throw s}async getCourseBooksWithDetails(e){let{data:t,error:s}=await this.supabase.from("course_books").select(`
        *,
        book:books (
          id,
          title,
          author,
          isbn,
          publisher,
          publication_year,
          cover_image_url,
          content_type,
          file_url
        )
      `).eq("course_id",e).order("position",{ascending:!0});if(s)throw s;return t}async getCoursesUsingBook(e){let{data:t,error:s}=await this.supabase.from("course_books").select(`
        *,
        course:courses (
          id,
          title,
          description,
          status,
          difficulty
        )
      `).eq("book_id",e);if(s)throw s;return t}async updateCourseBook(e,t,s){let{data:a,error:r}=await this.supabase.from("course_books").update({is_required:s.isRequired,notes:s.notes,position:s.position}).match({course_id:e,book_id:t}).select().single();if(r)throw r;return a}async reorderCourseBooks(e,t){let s=t.map(({bookId:t,position:s})=>this.supabase.from("course_books").update({position:s}).match({course_id:e,book_id:t})),a=(await Promise.all(s)).filter(e=>e.error);if(a.length>0)throw Error(`Failed to reorder books: ${a.map(e=>e.error?.message).join(", ")}`)}async bulkAddBooksToCourse(e,t,s=!1){let a=t.map((t,a)=>({course_id:e,book_id:t,is_required:s,position:a})),{data:r,error:i}=await this.supabase.from("course_books").insert(a).select();if(i)throw i;return r}async isBookInCourse(e,t){let{data:s,error:a}=await this.supabase.from("course_books").select("id").match({course_id:e,book_id:t}).single();if(a&&"PGRST116"!==a.code)throw a;return!!s}constructor(){this.supabase=(0,d.J)()}}let m=new u;class h{async addVocabularyGroupToCourse(e,t,s){let{data:a,error:r}=await this.supabase.from("course_vocabulary_groups").insert({course_id:e,vocabulary_group_id:t,position:s??0}).select().single();if(r)throw r;return a}async removeVocabularyGroupFromCourse(e,t){let{error:s}=await this.supabase.from("course_vocabulary_groups").delete().match({course_id:e,vocabulary_group_id:t});if(s)throw s}async getCourseVocabularyGroups(e){let{data:t,error:s}=await this.supabase.from("course_vocabulary_groups").select(`
        *,
        vocabulary_group:vocabulary_groups (
          id,
          name,
          description,
          language,
          target_language,
          difficulty,
          tags,
          vocabulary_group_items (
            vocabulary:vocabulary (
              id,
              word,
              translation,
              part_of_speech,
              difficulty
            )
          )
        )
      `).eq("course_id",e).order("position",{ascending:!0});if(s)throw s;return t}async getCourseVocabularyItems(e){let{data:t,error:s}=await this.supabase.from("course_vocabulary_groups").select(`
        vocabulary_group:vocabulary_groups (
          id,
          name,
          vocabulary_group_items (
            vocabulary:vocabulary (*)
          )
        )
      `).eq("course_id",e);if(s)throw s;return t?.flatMap(e=>{let t=e.vocabulary_group;return t?.vocabulary_group_items?.map(e=>e.vocabulary)??[]}).filter(Boolean)}async getCoursesUsingVocabularyGroup(e){let{data:t,error:s}=await this.supabase.from("course_vocabulary_groups").select(`
        *,
        course:courses (
          id,
          title,
          description,
          status,
          difficulty
        )
      `).eq("vocabulary_group_id",e);if(s)throw s;return t}async reorderCourseVocabularyGroups(e,t){let s=t.map(({groupId:t,position:s})=>this.supabase.from("course_vocabulary_groups").update({position:s}).match({course_id:e,vocabulary_group_id:t})),a=(await Promise.all(s)).filter(e=>e.error);if(a.length>0)throw Error(`Failed to reorder vocabulary groups: ${a.map(e=>e.error?.message).join(", ")}`)}async bulkAddVocabularyGroupsToCourse(e,t){let s=t.map((t,s)=>({course_id:e,vocabulary_group_id:t,position:s})),{data:a,error:r}=await this.supabase.from("course_vocabulary_groups").insert(s).select();if(r)throw r;return a}async getCourseVocabularyStats(e){let t=await this.getCourseVocabularyItems(e),s={totalWords:t.length,byDifficulty:{},byPartOfSpeech:{},languages:new Set};return t.forEach(e=>{if(e){let t=e.difficulty||"unknown";s.byDifficulty[t]=(s.byDifficulty[t]||0)+1;let a=e.part_of_speech||"unknown";s.byPartOfSpeech[a]=(s.byPartOfSpeech[a]||0)+1}}),s}constructor(){this.supabase=(0,d.J)()}}let g=new h;class y{async linkScheduleToCourse(e,t){let{data:s,error:a}=await this.supabase.from("schedules").update({course_id:t}).eq("id",e).select().single();if(a)throw a;return s}async unlinkScheduleFromCourse(e){let{data:t,error:s}=await this.supabase.from("schedules").update({course_id:null}).eq("id",e).select().single();if(s)throw s;return t}async getCourseSchedules(e){let{data:t,error:s}=await this.supabase.from("schedules").select(`
        *,
        lessons (
          id,
          title,
          date,
          start_time,
          end_time,
          status
        )
      `).eq("course_id",e).order("start_date",{ascending:!0});if(s)throw s;return t}async getActiveCourseSchedules(e){let{data:t,error:s}=await this.supabase.from("schedules").select(`
        *,
        lessons (
          id,
          title,
          date,
          start_time,
          end_time,
          status
        )
      `).eq("course_id",e).eq("is_active",!0).gte("end_date",new Date().toISOString().split("T")[0]).order("start_date",{ascending:!0});if(s)throw s;return t}async getScheduleCourse(e){let{data:t,error:s}=await this.supabase.from("schedules").select(`
        course:courses (
          id,
          title,
          description,
          status,
          difficulty
        )
      `).eq("id",e).single();if(s)throw s;return t?.course}async getCourseLessons(e){let{data:t,error:s}=await this.supabase.from("schedules").select(`
        lessons (
          *,
          schedule:schedules (
            id,
            name
          )
        )
      `).eq("course_id",e);if(s)throw s;return t?.flatMap(e=>e.lessons?.map(t=>({...t,schedule:e}))??[])}async getUpcomingCourseLessons(e,t=10){let s=new Date().toISOString().split("T")[0],{data:a,error:r}=await this.supabase.from("schedules").select(`
        lessons (
          *,
          schedule:schedules (
            id,
            name
          )
        )
      `).eq("course_id",e).eq("is_active",!0);if(r)throw r;return a?.flatMap(e=>e.lessons?.filter(e=>e.date>=s)??[]).sort((e,t)=>{let s=e.date.localeCompare(t.date);return 0!==s?s:e.start_time.localeCompare(t.start_time)}).slice(0,t)}async courseHasSchedules(e){let{count:t,error:s}=await this.supabase.from("schedules").select("*",{count:"exact",head:!0}).eq("course_id",e);if(s)throw s;return(t??0)>0}async getCourseProgress(e){let{data:t,error:s}=await this.supabase.from("schedules").select(`
        lessons (
          status
        )
      `).eq("course_id",e);if(s)throw s;let a=t?.flatMap(e=>e.lessons??[])??[],r=a.filter(e=>"completed"===e.status);return{totalLessons:a.length,completedLessons:r.length,progressPercentage:a.length>0?Math.round(r.length/a.length*100):0}}async createCourseSchedule(e,t){let{data:s,error:a}=await this.supabase.auth.getUser();if(a)throw a;let{data:r,error:i}=await this.supabase.from("schedules").insert({...t,course_id:e,user_id:s.user.id}).select().single();if(i)throw i;return r}constructor(){this.supabase=(0,d.J)()}}new y;class p{async addObjectiveToLesson(e,t,s){let{data:a,error:r}=await this.supabase.from("lesson_objectives").insert({lesson_id:e,objective_id:t,position:s??0}).select().single();if(r)throw r;return a}async removeObjectiveFromLesson(e,t){let{error:s}=await this.supabase.from("lesson_objectives").delete().match({lesson_id:e,objective_id:t});if(s)throw s}async getLessonObjectives(e){let{data:t,error:s}=await this.supabase.from("lesson_objectives").select(`
        *,
        objective:objectives (*)
      `).eq("lesson_id",e).order("position",{ascending:!0});if(s)throw s;return t}async addMethodToLesson(e,t,s){let{data:a,error:r}=await this.supabase.from("lesson_methods").insert({lesson_id:e,method_id:t,duration_override:s?.durationOverride,position:s?.position??0,notes:s?.notes}).select().single();if(r)throw r;return a}async removeMethodFromLesson(e,t){let{error:s}=await this.supabase.from("lesson_methods").delete().match({lesson_id:e,method_id:t});if(s)throw s}async getLessonMethods(e){let{data:t,error:s}=await this.supabase.from("lesson_methods").select(`
        *,
        method:methods (*)
      `).eq("lesson_id",e).order("position",{ascending:!0});if(s)throw s;return t}async addTaskToLesson(e,t,s){let{data:a,error:r}=await this.supabase.from("lesson_tasks").insert({lesson_id:e,task_id:t,duration_override:s?.durationOverride,position:s?.position??0,notes:s?.notes,is_homework:s?.isHomework??!1,due_date:s?.dueDate}).select().single();if(r)throw r;return a}async removeTaskFromLesson(e,t){let{error:s}=await this.supabase.from("lesson_tasks").delete().match({lesson_id:e,task_id:t});if(s)throw s}async getLessonTasks(e){let{data:t,error:s}=await this.supabase.from("lesson_tasks").select(`
        *,
        task:tasks (*)
      `).eq("lesson_id",e).order("position",{ascending:!0});if(s)throw s;return t}async addBookToLesson(e,t,s){let{data:a,error:r}=await this.supabase.from("lesson_books").insert({lesson_id:e,book_id:t,pages_from:s?.pagesFrom,pages_to:s?.pagesTo,notes:s?.notes}).select().single();if(r)throw r;return a}async removeBookFromLesson(e,t){let{error:s}=await this.supabase.from("lesson_books").delete().match({lesson_id:e,book_id:t});if(s)throw s}async getLessonBooks(e){let{data:t,error:s}=await this.supabase.from("lesson_books").select(`
        *,
        book:books (
          id,
          title,
          author,
          cover_image_url
        )
      `).eq("lesson_id",e);if(s)throw s;return t}async addVocabularyToLesson(e,t,s){let{data:a,error:r}=await this.supabase.from("lesson_vocabulary").insert({lesson_id:e,vocabulary_id:t,position:s??0}).select().single();if(r)throw r;return a}async removeVocabularyFromLesson(e,t){let{error:s}=await this.supabase.from("lesson_vocabulary").delete().match({lesson_id:e,vocabulary_id:t});if(s)throw s}async getLessonVocabulary(e){let{data:t,error:s}=await this.supabase.from("lesson_vocabulary").select(`
        *,
        vocabulary:vocabulary (*)
      `).eq("lesson_id",e).order("position",{ascending:!0});if(s)throw s;return t}async bulkAddObjectivesToLesson(e,t){let s=t.map((t,s)=>({lesson_id:e,objective_id:t,position:s})),{data:a,error:r}=await this.supabase.from("lesson_objectives").insert(s).select();if(r)throw r;return a}async bulkAddMethodsToLesson(e,t){let s=t.map((t,s)=>({lesson_id:e,method_id:t.methodId,duration_override:t.durationOverride,notes:t.notes,position:s})),{data:a,error:r}=await this.supabase.from("lesson_methods").insert(s).select();if(r)throw r;return a}async bulkAddTasksToLesson(e,t){let s=t.map((t,s)=>({lesson_id:e,task_id:t.taskId,duration_override:t.durationOverride,notes:t.notes,is_homework:t.isHomework??!1,due_date:t.dueDate,position:s})),{data:a,error:r}=await this.supabase.from("lesson_tasks").insert(s).select();if(r)throw r;return a}async getLessonContent(e){let[t,s,a,r,i]=await Promise.all([this.getLessonObjectives(e),this.getLessonMethods(e),this.getLessonTasks(e),this.getLessonBooks(e),this.getLessonVocabulary(e)]);return{objectives:t,methods:s,tasks:a,books:r,vocabulary:i}}async copyLessonContent(e,t){let s=await this.getLessonContent(e);for(let e of(s.objectives.length>0&&await this.bulkAddObjectivesToLesson(t,s.objectives.map(e=>e.objective_id)),s.methods.length>0&&await this.bulkAddMethodsToLesson(t,s.methods.map(e=>({methodId:e.method_id,durationOverride:e.duration_override||void 0,notes:e.notes||void 0}))),s.tasks.length>0&&await this.bulkAddTasksToLesson(t,s.tasks.map(e=>({taskId:e.task_id,durationOverride:e.duration_override||void 0,notes:e.notes||void 0,isHomework:e.is_homework,dueDate:e.due_date||void 0}))),s.books))await this.addBookToLesson(t,e.book_id,{pagesFrom:e.pages_from||void 0,pagesTo:e.pages_to||void 0,notes:e.notes||void 0});if(s.vocabulary.length>0){let e=s.vocabulary.map((e,s)=>({lesson_id:t,vocabulary_id:e.vocabulary_id,position:s}));await this.supabase.from("lesson_vocabulary").insert(e)}}constructor(){this.supabase=(0,d.J)()}}let b=new p;var f=s(24408),x=s(71876),v=s(77506);function _({courseId:e,onUpdate:t}){let[s,d]=(0,r.useState)(!1),[u,h]=(0,r.useState)(""),[g,y]=(0,r.useState)([]),[p,b]=(0,r.useState)([]),[_,w]=(0,r.useState)([]),[j,k]=(0,r.useState)(!1),[N,C]=(0,r.useState)(!1),S=async()=>{try{let t=await m.getCourseBooksWithDetails(e);b(t||[])}catch(e){console.error("Failed to load course books:",e)}},q=async()=>{C(!0);try{let e=await f.a.getBooks(),t=p.map(e=>e.book_id),s=e.filter(e=>!t.includes(e.id));w(s)}catch(e){console.error("Failed to load available books:",e)}finally{C(!1)}},L=async()=>{d(!0),y([]),h(""),await q()},T=async()=>{if(0!==g.length){k(!0);try{await m.bulkAddBooksToCourse(e,g),y([]),await S(),t?.(),d(!1)}catch(e){console.error("Failed to add books:",e)}finally{k(!1)}}},z=async s=>{if(confirm("Are you sure you want to remove this book from the course?"))try{await m.removeBookFromCourse(e,s),await S(),t?.()}catch(e){console.error("Failed to remove book:",e)}},D=async(t,s)=>{try{await m.updateCourseBook(e,t,{isRequired:!s}),await S()}catch(e){console.error("Failed to update book:",e)}},O=e=>{g.includes(e)?y(g.filter(t=>t!==e)):y([...g,e])},U=_.filter(e=>(e.title||"").toLowerCase().includes(u.toLowerCase())||e.author?.toLowerCase().includes(u.toLowerCase())||e.isbn?.toLowerCase().includes(u.toLowerCase()));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-medium",children:"Course Books"}),(0,a.jsxs)(i.z,{onClick:L,size:"sm",children:[a.jsx(x.Z,{className:"h-4 w-4 mr-2"}),"Manage Books"]})]}),p.length>0?a.jsx("div",{className:"grid gap-4",children:p.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[e.book?.cover_image_url&&a.jsx("img",{src:e.book.cover_image_url,alt:e.book.title,className:"w-16 h-20 object-cover rounded"}),(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-medium",children:e.book?.title}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.book?.author}),e.book?.isbn&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:["ISBN: ",e.book.isbn]}),e.notes&&a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:e.notes})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(c.C,{variant:e.is_required?"default":"secondary",className:"cursor-pointer",onClick:()=>D(e.book_id,e.is_required),children:e.is_required?"Required":"Optional"}),a.jsx(i.z,{variant:"ghost",size:"sm",onClick:()=>z(e.book_id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20",children:"Remove"})]})]},e.id))}):a.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:"No books added to this course yet."})]}),a.jsx(o.u,{isOpen:s,onClose:()=>d(!1),title:"Add Books to Course",size:"lg",children:(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx(l.R,{value:u,onSearch:h,placeholder:"Search books by title, author, or ISBN..."}),N?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx(v.Z,{className:"h-8 w-8 animate-spin text-gray-400"})}):U.length>0?a.jsx("div",{className:"max-h-96 overflow-y-auto",children:a.jsx(n.iA,{columns:[{key:"select",label:a.jsx("input",{type:"checkbox",checked:U.length>0&&U.every(e=>g.includes(e.id)),onChange:e=>{e.target.checked?y(U.map(e=>e.id)):y([])},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),render:e=>a.jsx("input",{type:"checkbox",checked:g.includes(e.id),onChange:()=>O(e.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})},{key:"title",label:"Title",render:e=>(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium",children:e.title}),e.isbn&&(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["ISBN: ",e.isbn]})]})},{key:"author",label:"Author"},{key:"category",label:"Category",render:e=>e.category?.name||"-"},{key:"type",label:"Type",render:e=>a.jsx(c.C,{variant:"warning",children:e.content_type||"physical"})}],data:U})}):a.jsx("p",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:u?"No books found matching your search.":"No available books to add."}),(0,a.jsxs)("div",{className:"flex justify-between items-center border-t pt-4",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[g.length," book",1!==g.length?"s":""," selected"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(i.z,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),a.jsx(i.z,{onClick:T,disabled:0===g.length||j,loading:j,children:"Add Books"})]})]})]})})]})}var w=s(44778),j=s(98485),k=s(94019),N=s(6343);function C({courseId:e,onUpdate:t}){let[s,n]=(0,r.useState)(!1),[d,u]=(0,r.useState)(""),[m,h]=(0,r.useState)([]),[y,p]=(0,r.useState)([]),[b,f]=(0,r.useState)([]),[x,_]=(0,r.useState)(!1),[C,S]=(0,r.useState)(!1),[q,L]=(0,r.useState)(null),T=async()=>{try{let t=await g.getCourseVocabularyGroups(e);p(t||[]);let s=await g.getCourseVocabularyStats(e);L(s)}catch(e){console.error("Failed to load course vocabulary groups:",e)}},z=async()=>{S(!0);try{let e=await w.A.getVocabularyGroups(),t=y.map(e=>e.vocabulary_group_id),s=e.filter(e=>!t.includes(e.id));f(s)}catch(e){console.error("Failed to load available groups:",e)}finally{S(!1)}},D=async()=>{n(!0),h([]),u(""),await z()},O=async()=>{if(0!==m.length){_(!0);try{await g.bulkAddVocabularyGroupsToCourse(e,m),h([]),await T(),t?.(),n(!1)}catch(e){console.error("Failed to add vocabulary groups:",e)}finally{_(!1)}}},U=async s=>{if(confirm("Are you sure you want to remove this vocabulary group from the course?"))try{await g.removeVocabularyGroupFromCourse(e,s),await T(),t?.()}catch(e){console.error("Failed to remove vocabulary group:",e)}},B=e=>{m.includes(e)?h(m.filter(t=>t!==e)):h([...m,e])},A=b.filter(e=>e.name.toLowerCase().includes(d.toLowerCase())||e.description?.toLowerCase().includes(d.toLowerCase())||e.language?.toLowerCase().includes(d.toLowerCase())||e.target_language?.toLowerCase().includes(d.toLowerCase())),M=e=>{switch(e){case"beginner":return"success";case"intermediate":return"warning";case"advanced":return"danger";case"expert":return"secondary";default:return"default"}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-medium",children:"Vocabulary Groups"}),q&&q.totalWords>0&&(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Total words: ",q.totalWords]})]}),(0,a.jsxs)(i.z,{onClick:D,size:"sm",children:[a.jsx(j.Z,{className:"h-4 w-4 mr-2"}),"Manage Vocabulary"]})]}),y.length>0?a.jsx("div",{className:"grid gap-4",children:y.map(e=>{let t=e.vocabulary_group,s=t?.vocabulary_group_items?.length||0;return a.jsx("div",{className:"p-4 border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("h4",{className:"font-medium",children:t?.name}),a.jsx(c.C,{variant:M(t?.difficulty),children:t?.difficulty}),t?.language&&t?.target_language&&(0,a.jsxs)(c.C,{variant:"outline",children:[t.language," → ",t.target_language]})]}),t?.description&&a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:t.description}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-500 dark:text-gray-400",children:[(0,a.jsxs)("span",{children:[s," word",1!==s?"s":""]}),t?.tags&&t.tags.length>0&&(0,a.jsxs)("div",{className:"flex gap-1",children:[t.tags.slice(0,3).map(e=>a.jsx("span",{className:"px-2 py-0.5 bg-gray-100 dark:bg-gray-700 rounded text-xs",children:e},e)),t.tags.length>3&&(0,a.jsxs)("span",{className:"text-xs",children:["+",t.tags.length-3]})]})]})]}),a.jsx(i.z,{variant:"ghost",size:"sm",onClick:()=>U(e.vocabulary_group_id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20",children:a.jsx(k.Z,{className:"h-4 w-4"})})]})},e.id)})}):a.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:"No vocabulary groups added to this course yet."}),q&&q.totalWords>0&&(0,a.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[a.jsx("h4",{className:"font-medium mb-3",children:"Vocabulary Statistics"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-2",children:"By Difficulty:"}),a.jsx("ul",{className:"space-y-1",children:Object.entries(q.byDifficulty).map(([e,t])=>(0,a.jsxs)("li",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"capitalize text-gray-700 dark:text-gray-300",children:[e,":"]}),a.jsx("span",{className:"font-medium",children:t})]},e))})]}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-2",children:"By Part of Speech:"}),(0,a.jsxs)("ul",{className:"space-y-1",children:[Object.entries(q.byPartOfSpeech).slice(0,5).map(([e,t])=>(0,a.jsxs)("li",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"capitalize text-gray-700 dark:text-gray-300",children:[e,":"]}),a.jsx("span",{className:"font-medium",children:t})]},e)),Object.keys(q.byPartOfSpeech).length>5&&(0,a.jsxs)("li",{className:"text-gray-500 dark:text-gray-400 text-xs",children:["+",Object.keys(q.byPartOfSpeech).length-5," more"]})]})]})]})]})]}),a.jsx(o.u,{isOpen:s,onClose:()=>n(!1),title:"Add Vocabulary Groups",size:"lg",children:(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx(l.R,{value:d,onSearch:u,placeholder:"Search vocabulary groups by name, description, or language..."}),C?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx(v.Z,{className:"h-8 w-8 animate-spin text-gray-400"})}):A.length>0?a.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:A.map(e=>a.jsx("div",{className:`p-3 border rounded-lg cursor-pointer transition-all ${m.includes(e.id)?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"hover:bg-gray-50 dark:hover:bg-gray-800"}`,onClick:()=>B(e.id),children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[a.jsx("input",{type:"checkbox",checked:m.includes(e.id),onChange:()=>{},className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500",onClick:e=>e.stopPropagation()}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("h5",{className:"font-medium",children:e.name}),a.jsx(c.C,{variant:M(e.difficulty),size:"sm",children:e.difficulty}),e.language&&e.target_language&&(0,a.jsxs)(c.C,{variant:"outline",size:"sm",children:[e.language," → ",e.target_language]})]}),e.description&&a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-1 text-xs text-gray-500 dark:text-gray-400",children:[(0,a.jsxs)("span",{children:[e.vocabulary_group_items?.length||0," words"]}),e.tags&&e.tags.length>0&&(0,a.jsxs)("span",{children:[e.tags.length," tags"]})]})]})]}),a.jsx(N.Z,{className:"h-4 w-4 text-gray-400 mt-1"})]})},e.id))}):a.jsx("p",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:d?"No vocabulary groups found matching your search.":"No available vocabulary groups to add."}),(0,a.jsxs)("div",{className:"flex justify-between items-center border-t pt-4",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[m.length," group",1!==m.length?"s":""," selected"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(i.z,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),a.jsx(i.z,{onClick:O,disabled:0===m.length||x,loading:x,children:"Add Groups"})]})]})]})})]})}var S=s(92520),q=s(59813);let L=(0,q.createClientComponentClient)(),T={async getObjectives(e={}){let t=L.from("objectives").select(`
        *,
        category:categories(id, name, color, icon)
      `).order("created_at",{ascending:!1});e.categoryId&&(t=t.eq("category_id",e.categoryId)),e.bloomLevel&&(t=t.eq("bloom_level",e.bloomLevel)),void 0!==e.measurable&&(t=t.eq("measurable",e.measurable)),void 0!==e.isTemplate&&(t=t.eq("is_template",e.isTemplate)),e.search&&(t=t.or(`title.ilike.%${e.search}%,description.ilike.%${e.search}%`)),e.tags&&e.tags.length>0&&(t=t.contains("tags",e.tags));let{data:s,error:a}=await t;if(a)throw a;return s},async getObjective(e){let{data:t,error:s}=await L.from("objectives").select(`
        *,
        category:categories(id, name, color, icon)
      `).eq("id",e).single();if(s)throw s;return t},async createObjective(e){let{data:t}=await L.auth.getUser();if(!t.user)throw Error("User not authenticated");let{data:s,error:a}=await L.from("objectives").insert({...e,user_id:t.user.id,measurable:e.measurable??!0,is_template:e.is_template??!1}).select().single();if(a)throw a;return s},async updateObjective({id:e,...t}){let{data:s,error:a}=await L.from("objectives").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(a)throw a;return s},async deleteObjective(e){let{error:t}=await L.from("objectives").delete().eq("id",e);if(t)throw t},getBloomLevels:()=>[{value:"remember",label:"Remember"},{value:"understand",label:"Understand"},{value:"apply",label:"Apply"},{value:"analyze",label:"Analyze"},{value:"evaluate",label:"Evaluate"},{value:"create",label:"Create"}],async getObjectivesByCategory(e){let{data:t,error:s}=await L.from("objectives").select("*").eq("category_id",e).order("title",{ascending:!0});if(s)throw s;return t},async getTemplateObjectives(){let{data:e,error:t}=await L.from("objectives").select("*").eq("is_template",!0).order("title",{ascending:!0});if(t)throw t;return e},async cloneAsTemplate(e,t){let s=await this.getObjective(e);return this.createObjective({title:t||`${s.title} (Template)`,description:s.description,category_id:s.category_id,bloom_level:s.bloom_level,measurable:s.measurable,tags:s.tags,is_template:!0})},async getObjectiveStats(){let{data:e}=await L.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:s}=await L.from("objectives").select("bloom_level, is_template",{count:"exact"}).eq("user_id",e.user.id);if(s)throw s;return{total:t?.length||0,templates:t?.filter(e=>e.is_template).length||0,byBloomLevel:{remember:t?.filter(e=>"remember"===e.bloom_level).length||0,understand:t?.filter(e=>"understand"===e.bloom_level).length||0,apply:t?.filter(e=>"apply"===e.bloom_level).length||0,analyze:t?.filter(e=>"analyze"===e.bloom_level).length||0,evaluate:t?.filter(e=>"evaluate"===e.bloom_level).length||0,create:t?.filter(e=>"create"===e.bloom_level).length||0}}}},z=(0,q.createClientComponentClient)(),D={async getMethods(e={}){let t=z.from("methods").select(`
        *,
        category:categories(id, name, color, icon)
      `).order("created_at",{ascending:!1});e.categoryId&&(t=t.eq("category_id",e.categoryId)),void 0!==e.durationMin&&(t=t.gte("duration_minutes",e.durationMin)),void 0!==e.durationMax&&(t=t.lte("duration_minutes",e.durationMax)),void 0!==e.groupSizeMin&&(t=t.gte("group_size_min",e.groupSizeMin)),void 0!==e.groupSizeMax&&(t=t.lte("group_size_max",e.groupSizeMax)),void 0!==e.isTemplate&&(t=t.eq("is_template",e.isTemplate)),e.search&&(t=t.or(`name.ilike.%${e.search}%,description.ilike.%${e.search}%,instructions.ilike.%${e.search}%`)),e.tags&&e.tags.length>0&&(t=t.contains("tags",e.tags));let{data:s,error:a}=await t;if(a)throw a;return s},async getMethod(e){let{data:t,error:s}=await z.from("methods").select(`
        *,
        category:categories(id, name, color, icon)
      `).eq("id",e).single();if(s)throw s;return t},async createMethod(e){let{data:t}=await z.auth.getUser();if(!t.user)throw Error("User not authenticated");let{data:s,error:a}=await z.from("methods").insert({...e,user_id:t.user.id,group_size_min:e.group_size_min??1,is_template:e.is_template??!1}).select().single();if(a)throw a;return s},async updateMethod({id:e,...t}){let{data:s,error:a}=await z.from("methods").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(a)throw a;return s},async deleteMethod(e){let{error:t}=await z.from("methods").delete().eq("id",e);if(t)throw t},async getMethodsByCategory(e){let{data:t,error:s}=await z.from("methods").select("*").eq("category_id",e).order("name",{ascending:!0});if(s)throw s;return t},async getTemplateMethods(){let{data:e,error:t}=await z.from("methods").select("*").eq("is_template",!0).order("name",{ascending:!0});if(t)throw t;return e},async getMethodsByDuration(e,t){let{data:s,error:a}=await z.from("methods").select("*").gte("duration_minutes",e).lte("duration_minutes",t).order("duration_minutes",{ascending:!0});if(a)throw a;return s},async getMethodsByGroupSize(e){let{data:t,error:s}=await z.from("methods").select("*").lte("group_size_min",e).or(`group_size_max.gte.${e},group_size_max.is.null`).order("name",{ascending:!0});if(s)throw s;return t},async cloneAsTemplate(e,t){let s=await this.getMethod(e);return this.createMethod({name:t||`${s.name} (Template)`,description:s.description,category_id:s.category_id,instructions:s.instructions,duration_minutes:s.duration_minutes,group_size_min:s.group_size_min,group_size_max:s.group_size_max,materials_needed:s.materials_needed,tags:s.tags,is_template:!0})},async getMethodStats(){let{data:e}=await z.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:s}=await z.from("methods").select("duration_minutes, group_size_min, group_size_max, is_template",{count:"exact"}).eq("user_id",e.user.id);if(s)throw s;return{total:t?.length||0,templates:t?.filter(e=>e.is_template).length||0,averageDuration:t?.length?Math.round(t.reduce((e,t)=>e+(t.duration_minutes||0),0)/t.length):0,byDurationRange:{short:t?.filter(e=>15>=(e.duration_minutes||0)).length||0,medium:t?.filter(e=>(e.duration_minutes||0)>15&&45>=(e.duration_minutes||0)).length||0,long:t?.filter(e=>(e.duration_minutes||0)>45).length||0},byGroupSize:{individual:t?.filter(e=>1===(e.group_size_min||1)&&1===(e.group_size_max||1)).length||0,small:t?.filter(e=>5>=(e.group_size_min||1)&&(e.group_size_max||100)>1).length||0,large:t?.filter(e=>(e.group_size_min||1)>5).length||0}}},async getPopularMaterials(e=10){let{data:t}=await z.auth.getUser();if(!t.user)throw Error("User not authenticated");let{data:s,error:a}=await z.from("methods").select("materials_needed").eq("user_id",t.user.id).not("materials_needed","is",null);if(a)throw a;let r={};return s?.forEach(e=>{e.materials_needed?.forEach(e=>{r[e]=(r[e]||0)+1})}),Object.entries(r).sort(([,e],[,t])=>t-e).slice(0,e).map(([e,t])=>({material:e,count:t}))}},O=(0,q.createClientComponentClient)(),U={async getTasks(e={}){let t=O.from("tasks").select(`
        *,
        category:categories(id, name, color, icon)
      `).order("created_at",{ascending:!1});e.categoryId&&(t=t.eq("category_id",e.categoryId)),e.difficulty&&(t=t.eq("difficulty",e.difficulty)),void 0!==e.durationMin&&(t=t.gte("duration_minutes",e.durationMin)),void 0!==e.durationMax&&(t=t.lte("duration_minutes",e.durationMax)),void 0!==e.isTemplate&&(t=t.eq("is_template",e.isTemplate)),e.search&&(t=t.or(`title.ilike.%${e.search}%,description.ilike.%${e.search}%,instructions.ilike.%${e.search}%`)),e.tags&&e.tags.length>0&&(t=t.contains("tags",e.tags));let{data:s,error:a}=await t;if(a)throw a;return s},async getTask(e){let{data:t,error:s}=await O.from("tasks").select(`
        *,
        category:categories(id, name, color, icon)
      `).eq("id",e).single();if(s)throw s;return t},async createTask(e){let{data:t}=await O.auth.getUser();if(!t.user)throw Error("User not authenticated");let{data:s,error:a}=await O.from("tasks").insert({...e,user_id:t.user.id,difficulty:e.difficulty??"beginner",is_template:e.is_template??!1}).select().single();if(a)throw a;return s},async updateTask({id:e,...t}){let{data:s,error:a}=await O.from("tasks").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(a)throw a;return s},async deleteTask(e){let{error:t}=await O.from("tasks").delete().eq("id",e);if(t)throw t},async getTasksByCategory(e){let{data:t,error:s}=await O.from("tasks").select("*").eq("category_id",e).order("title",{ascending:!0});if(s)throw s;return t},async getTemplateTasks(){let{data:e,error:t}=await O.from("tasks").select("*").eq("is_template",!0).order("title",{ascending:!0});if(t)throw t;return e},async getTasksByDifficulty(e){let{data:t,error:s}=await O.from("tasks").select("*").eq("difficulty",e).order("title",{ascending:!0});if(s)throw s;return t},async getTasksByDuration(e,t){let{data:s,error:a}=await O.from("tasks").select("*").gte("duration_minutes",e).lte("duration_minutes",t).order("duration_minutes",{ascending:!0});if(a)throw a;return s},async cloneAsTemplate(e,t){let s=await this.getTask(e);return this.createTask({title:t||`${s.title} (Template)`,description:s.description,category_id:s.category_id,instructions:s.instructions,duration_minutes:s.duration_minutes,difficulty:s.difficulty,materials_needed:s.materials_needed,assessment_criteria:s.assessment_criteria,tags:s.tags,is_template:!0})},async getTaskStats(){let{data:e}=await O.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:s}=await O.from("tasks").select("difficulty, duration_minutes, is_template",{count:"exact"}).eq("user_id",e.user.id);if(s)throw s;return{total:t?.length||0,templates:t?.filter(e=>e.is_template).length||0,averageDuration:t?.length?Math.round(t.reduce((e,t)=>e+(t.duration_minutes||0),0)/t.length):0,byDifficulty:{beginner:t?.filter(e=>"beginner"===e.difficulty).length||0,intermediate:t?.filter(e=>"intermediate"===e.difficulty).length||0,advanced:t?.filter(e=>"advanced"===e.difficulty).length||0,expert:t?.filter(e=>"expert"===e.difficulty).length||0},byDurationRange:{short:t?.filter(e=>15>=(e.duration_minutes||0)).length||0,medium:t?.filter(e=>(e.duration_minutes||0)>15&&45>=(e.duration_minutes||0)).length||0,long:t?.filter(e=>(e.duration_minutes||0)>45).length||0}}},async getPopularMaterials(e=10){let{data:t}=await O.auth.getUser();if(!t.user)throw Error("User not authenticated");let{data:s,error:a}=await O.from("tasks").select("materials_needed").eq("user_id",t.user.id).not("materials_needed","is",null);if(a)throw a;let r={};return s?.forEach(e=>{e.materials_needed?.forEach(e=>{r[e]=(r[e]||0)+1})}),Object.entries(r).sort(([,e],[,t])=>t-e).slice(0,e).map(([e,t])=>({material:e,count:t}))},async getTasksForLessonDuration(e,t=5){let{data:s,error:a}=await O.from("tasks").select("*").lte("duration_minutes",e-t).order("duration_minutes",{ascending:!1});if(a)throw a;return s},getAssessmentCriteriaSuggestions:()=>["Accuracy of completion","Time management","Following instructions","Creativity and innovation","Collaboration and teamwork","Communication skills","Problem-solving approach","Quality of final product","Use of resources","Reflection and self-assessment"],getDifficultyDescriptions:()=>({beginner:"Basic concepts, minimal prior knowledge required",intermediate:"Some familiarity with topic, moderate complexity",advanced:"Strong foundation required, complex problem-solving",expert:"Mastery level, highly complex and nuanced tasks"})};var B=s(53468),A=s(82189),M=s(48238),$=s(83855),I=s(48998),V=s(24061),F=s(37358);function Z({lessonId:e,onUpdate:t}){let[s,n]=(0,r.useState)("objectives"),[d,u]=(0,r.useState)({objectives:[],methods:[],tasks:[],books:[],vocabulary:[]}),[m,h]=(0,r.useState)(!0),[g,y]=(0,r.useState)(!1),[p,_]=(0,r.useState)("objectives"),[N,C]=(0,r.useState)(""),[q,L]=(0,r.useState)([]),[z,O]=(0,r.useState)([]),[Z,P]=(0,r.useState)(!1),[E,G]=(0,r.useState)(!1),R=async()=>{h(!0);try{let t=await b.getLessonContent(e);u(t)}catch(e){console.error("Failed to load lesson content:",e)}finally{h(!1)}},H=async e=>{P(!0);try{let t=[],s=d[e].map(t=>{switch(e){case"objectives":return t.objective_id;case"methods":return t.method_id;case"tasks":return t.task_id;case"books":return t.book_id;case"vocabulary":return t.vocabulary_id;default:return null}}).filter(Boolean);switch(e){case"objectives":t=(await T.getObjectives()).filter(e=>!s.includes(e.id));break;case"methods":t=(await D.getMethods()).filter(e=>!s.includes(e.id));break;case"tasks":t=(await U.getTasks()).filter(e=>!s.includes(e.id));break;case"books":t=(await f.a.getBooks()).filter(e=>!s.includes(e.id));break;case"vocabulary":t=(await w.A.getVocabulary()).filter(e=>!s.includes(e.id))}L(t)}catch(t){console.error(`Failed to load available ${e}:`,t)}finally{P(!1)}},W=async e=>{_(e),y(!0),C(""),O([]),await H(e)},J=async(s,a)=>{if(confirm(`Are you sure you want to remove this ${s.slice(0,-1)}?`))try{switch(s){case"objectives":await b.removeObjectiveFromLesson(e,a);break;case"methods":await b.removeMethodFromLesson(e,a);break;case"tasks":await b.removeTaskFromLesson(e,a);break;case"books":await b.removeBookFromLesson(e,a);break;case"vocabulary":await b.removeVocabularyFromLesson(e,a)}await R(),t?.()}catch(e){console.error(`Failed to remove ${s}:`,e)}},Y=async()=>{if(0!==z.length){G(!0);try{switch(p){case"objectives":await b.bulkAddObjectivesToLesson(e,z);break;case"methods":await b.bulkAddMethodsToLesson(e,z.map(e=>({methodId:e})));break;case"tasks":await b.bulkAddTasksToLesson(e,z.map(e=>({taskId:e})));break;case"books":for(let t of z)await b.addBookToLesson(e,t);break;case"vocabulary":for(let t of z)await b.addVocabularyToLesson(e,t)}await R(),t?.(),y(!1)}catch(e){console.error(`Failed to add ${p}:`,e)}finally{G(!1)}}},Q=e=>{z.includes(e)?O(z.filter(t=>t!==e)):O([...z,e])},K=()=>N?q.filter(e=>{let t=N.toLowerCase();switch(p){case"objectives":case"tasks":return e.title?.toLowerCase().includes(t)||e.description?.toLowerCase().includes(t);case"methods":return e.name?.toLowerCase().includes(t)||e.description?.toLowerCase().includes(t);case"books":return e.title?.toLowerCase().includes(t)||e.author?.toLowerCase().includes(t)||e.isbn?.toLowerCase().includes(t);case"vocabulary":return e.word?.toLowerCase().includes(t)||e.translation?.toLowerCase().includes(t);default:return!0}}):q,X=[{key:"objectives",label:"Objectives",icon:a.jsx(B.Z,{className:"h-4 w-4"}),count:d.objectives.length},{key:"methods",label:"Methods",icon:a.jsx(A.Z,{className:"h-4 w-4"}),count:d.methods.length},{key:"tasks",label:"Tasks",icon:a.jsx(M.Z,{className:"h-4 w-4"}),count:d.tasks.length},{key:"books",label:"Books",icon:a.jsx(x.Z,{className:"h-4 w-4"}),count:d.books.length},{key:"vocabulary",label:"Vocabulary",icon:a.jsx(j.Z,{className:"h-4 w-4"}),count:d.vocabulary.length}],ee=()=>{if(m)return a.jsx("div",{className:"flex justify-center py-8",children:a.jsx(v.Z,{className:"h-8 w-8 animate-spin text-gray-400"})});if(0===d[s].length)return(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsxs)("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:["No ",s," added to this lesson yet."]}),(0,a.jsxs)(i.z,{onClick:()=>W(s),children:[a.jsx($.Z,{className:"h-4 w-4 mr-2"}),"Add ",s]})]});switch(s){case"objectives":return a.jsx("div",{className:"space-y-3",children:d.objectives.map(e=>(0,a.jsxs)("div",{className:"flex items-start justify-between p-3 border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium",children:e.objective?.title}),e.objective?.description&&a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.objective.description}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[e.objective?.bloom_level&&a.jsx(c.C,{variant:"outline",size:"sm",children:e.objective.bloom_level}),e.objective?.category&&a.jsx(c.C,{variant:"secondary",size:"sm",children:e.objective.category})]})]}),a.jsx(i.z,{variant:"ghost",size:"sm",onClick:()=>J("objectives",e.objective_id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20",children:a.jsx(k.Z,{className:"h-4 w-4"})})]},e.id))});case"methods":return a.jsx("div",{className:"space-y-3",children:d.methods.map(e=>(0,a.jsxs)("div",{className:"flex items-start justify-between p-3 border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium",children:e.method?.name}),e.method?.description&&a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.method.description}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-500 dark:text-gray-400",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[a.jsx(I.Z,{className:"h-3 w-3"}),e.duration_override||e.method?.duration_minutes," min"]}),e.method?.group_size_min&&e.method?.group_size_max&&(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[a.jsx(V.Z,{className:"h-3 w-3"}),e.method.group_size_min,"-",e.method.group_size_max]}),e.method?.category&&a.jsx(c.C,{variant:"outline",size:"sm",children:e.method.category})]}),e.notes&&(0,a.jsxs)("p",{className:"text-sm text-blue-600 dark:text-blue-400 mt-2",children:["Note: ",e.notes]})]}),a.jsx(i.z,{variant:"ghost",size:"sm",onClick:()=>J("methods",e.method_id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20",children:a.jsx(k.Z,{className:"h-4 w-4"})})]},e.id))});case"tasks":return a.jsx("div",{className:"space-y-3",children:d.tasks.map(e=>(0,a.jsxs)("div",{className:"flex items-start justify-between p-3 border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("h4",{className:"font-medium",children:e.task?.title}),e.is_homework&&a.jsx(c.C,{variant:"warning",size:"sm",children:"Homework"})]}),e.task?.description&&a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.task.description}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-500 dark:text-gray-400",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[a.jsx(I.Z,{className:"h-3 w-3"}),e.duration_override||e.task?.duration_minutes," min"]}),e.task?.difficulty&&a.jsx(c.C,{variant:"outline",size:"sm",children:e.task.difficulty}),e.due_date&&(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[a.jsx(F.Z,{className:"h-3 w-3"}),"Due: ",new Date(e.due_date).toLocaleDateString()]})]}),e.notes&&(0,a.jsxs)("p",{className:"text-sm text-blue-600 dark:text-blue-400 mt-2",children:["Note: ",e.notes]})]}),a.jsx(i.z,{variant:"ghost",size:"sm",onClick:()=>J("tasks",e.task_id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20",children:a.jsx(k.Z,{className:"h-4 w-4"})})]},e.id))});case"books":return a.jsx("div",{className:"space-y-3",children:d.books.map(e=>(0,a.jsxs)("div",{className:"flex items-start justify-between p-3 border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[e.book?.cover_image_url&&a.jsx("img",{src:e.book.cover_image_url,alt:e.book.title,className:"w-12 h-16 object-cover rounded"}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium",children:e.book?.title}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.book?.author}),(e.pages_from||e.pages_to)&&(0,a.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["Pages: ",e.pages_from||"?"," - ",e.pages_to||"?"]}),e.notes&&(0,a.jsxs)("p",{className:"text-sm text-blue-600 dark:text-blue-400 mt-1",children:["Note: ",e.notes]})]})]}),a.jsx(i.z,{variant:"ghost",size:"sm",onClick:()=>J("books",e.book_id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20",children:a.jsx(k.Z,{className:"h-4 w-4"})})]},e.id))});case"vocabulary":return a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:d.vocabulary.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium",children:e.vocabulary?.word}),e.vocabulary?.translation&&a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.vocabulary.translation}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[e.vocabulary?.part_of_speech&&a.jsx(c.C,{variant:"outline",size:"sm",children:e.vocabulary.part_of_speech}),e.vocabulary?.difficulty&&a.jsx(c.C,{variant:"secondary",size:"sm",children:e.vocabulary.difficulty})]})]}),a.jsx(i.z,{variant:"ghost",size:"sm",onClick:()=>J("vocabulary",e.vocabulary_id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20",children:a.jsx(k.Z,{className:"h-4 w-4"})})]},e.id))});default:return null}};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-medium",children:"Lesson Content"}),(0,a.jsxs)(i.z,{size:"sm",onClick:()=>W(s),disabled:m,children:[a.jsx($.Z,{className:"h-4 w-4 mr-2"}),"Add ",s.slice(0,-1)]})]}),(0,a.jsxs)(S.mQ,{value:s,onValueChange:n,children:[" ",(0,a.jsxs)(S.dr,{className:"w-full justify-start overflow-x-auto",children:[" ",X.map(e=>(0,a.jsxs)(S.SP,{value:e.key,children:[" ",(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[" ",e.icon," ",e.label," ",e.count>0&&(0,a.jsxs)(c.C,{variant:"secondary",className:"ml-1",children:[" ",e.count," "]})]})]},e.key))]}),X.map(e=>a.jsx(S.nU,{value:e.key,children:ee()},e.key))]}),a.jsx(o.u,{isOpen:g,onClose:()=>y(!1),title:`Add ${p.charAt(0).toUpperCase()+p.slice(1)} to Lesson`,size:"lg",children:(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx(l.R,{value:N,onSearch:C,placeholder:`Search ${p}...`}),(()=>{let e=K();if(Z)return a.jsx("div",{className:"flex justify-center py-8",children:a.jsx(v.Z,{className:"h-8 w-8 animate-spin text-gray-400"})});if(0===e.length)return a.jsx("p",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:N?`No ${p} found matching your search.`:`No available ${p} to add.`});switch(p){case"objectives":return a.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:e.map(e=>a.jsx("div",{className:`p-3 border rounded-lg cursor-pointer transition-all ${z.includes(e.id)?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"hover:bg-gray-50 dark:hover:bg-gray-800"}`,onClick:()=>Q(e.id),children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx("input",{type:"checkbox",checked:z.includes(e.id),onChange:()=>{},className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500",onClick:e=>e.stopPropagation()}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h5",{className:"font-medium",children:e.title}),e.description&&a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[e.bloom_level&&a.jsx(c.C,{variant:"outline",size:"sm",children:e.bloom_level}),e.category&&a.jsx(c.C,{variant:"secondary",size:"sm",children:e.category})]})]})]})},e.id))});case"methods":return a.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:e.map(e=>a.jsx("div",{className:`p-3 border rounded-lg cursor-pointer transition-all ${z.includes(e.id)?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"hover:bg-gray-50 dark:hover:bg-gray-800"}`,onClick:()=>Q(e.id),children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx("input",{type:"checkbox",checked:z.includes(e.id),onChange:()=>{},className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500",onClick:e=>e.stopPropagation()}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h5",{className:"font-medium",children:e.name}),e.description&&a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-2 text-sm text-gray-500",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[a.jsx(I.Z,{className:"h-3 w-3"}),e.duration_minutes," min"]}),e.group_size_min&&e.group_size_max&&(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[a.jsx(V.Z,{className:"h-3 w-3"}),e.group_size_min,"-",e.group_size_max]})]})]})]})},e.id))});case"tasks":return a.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:e.map(e=>a.jsx("div",{className:`p-3 border rounded-lg cursor-pointer transition-all ${z.includes(e.id)?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"hover:bg-gray-50 dark:hover:bg-gray-800"}`,onClick:()=>Q(e.id),children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx("input",{type:"checkbox",checked:z.includes(e.id),onChange:()=>{},className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500",onClick:e=>e.stopPropagation()}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h5",{className:"font-medium",children:e.title}),e.description&&a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-2",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[a.jsx(I.Z,{className:"h-3 w-3 inline mr-1"}),e.duration_minutes," min"]}),e.difficulty&&a.jsx(c.C,{variant:"outline",size:"sm",children:e.difficulty})]})]})]})},e.id))});case"books":return a.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:e.map(e=>a.jsx("div",{className:`p-3 border rounded-lg cursor-pointer transition-all ${z.includes(e.id)?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"hover:bg-gray-50 dark:hover:bg-gray-800"}`,onClick:()=>Q(e.id),children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx("input",{type:"checkbox",checked:z.includes(e.id),onChange:()=>{},className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500",onClick:e=>e.stopPropagation()}),e.cover_image_url&&a.jsx("img",{src:e.cover_image_url,alt:e.title,className:"w-12 h-16 object-cover rounded"}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h5",{className:"font-medium",children:e.title}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.author}),e.isbn&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["ISBN: ",e.isbn]})]})]})},e.id))});case"vocabulary":return a.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:e.map(e=>a.jsx("div",{className:`p-3 border rounded-lg cursor-pointer transition-all ${z.includes(e.id)?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"hover:bg-gray-50 dark:hover:bg-gray-800"}`,onClick:()=>Q(e.id),children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx("input",{type:"checkbox",checked:z.includes(e.id),onChange:()=>{},className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500",onClick:e=>e.stopPropagation()}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h5",{className:"font-medium",children:e.word}),e.translation&&a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.translation}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[e.part_of_speech&&a.jsx(c.C,{variant:"outline",size:"sm",children:e.part_of_speech}),e.difficulty&&a.jsx(c.C,{variant:"secondary",size:"sm",children:e.difficulty})]})]})]})},e.id))});default:return null}})(),(0,a.jsxs)("div",{className:"flex justify-between items-center border-t pt-4",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[z.length," ",p.slice(0,-1),1!==z.length?"s":""," selected"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(i.z,{variant:"outline",onClick:()=>y(!1),children:"Cancel"}),(0,a.jsxs)(i.z,{onClick:Y,disabled:0===z.length||E,loading:E,children:["Add ",p]})]})]})]})})]})}var P=s(35047);s(81254),s(59851);var E=s(47375),G=s(77636),R=s(39183);function H({courseId:e}){let t=(0,P.useRouter)(),[s,o]=(0,r.useState)([]),[l,n]=(0,r.useState)([]),[d,u]=(0,r.useState)(!0),m=e=>{try{return new Date(`2000-01-01T${e}`).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return e}},h=e=>{try{return new Date(e).toLocaleDateString([],{weekday:"short",month:"short",day:"numeric"})}catch{return e}},g=e=>{switch(e){case"completed":return"success";case"cancelled":return"danger";default:return"default"}};return d?a.jsx("div",{className:"text-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-gray-100 mx-auto"})}):0===s.length?(0,a.jsxs)("div",{className:"text-center py-16",children:[a.jsx(F.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"No schedules yet"}),a.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Create a teaching schedule for this course"}),(0,a.jsxs)(i.z,{className:"mt-4",size:"sm",onClick:()=>t.push(`/schedules/new?courseId=${e}`),children:[a.jsx($.Z,{className:"h-4 w-4 mr-2"}),"Create Schedule"]})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-medium",children:"Course Schedules"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:[s.length," schedule",1!==s.length?"s":"",", ",l.length," lesson",1!==l.length?"s":""]})]}),(0,a.jsxs)(i.z,{variant:"outline",size:"sm",onClick:()=>t.push(`/schedules/new?courseId=${e}`),children:[a.jsx($.Z,{className:"h-4 w-4 mr-2"}),"New Schedule"]})]}),a.jsx("div",{className:"space-y-3",children:l.map(e=>a.jsx(E.Z,{className:"hover:shadow-md transition-shadow cursor-pointer",onClick:()=>t.push(`/lessons/${e.id}`),children:a.jsx(E.Z.Content,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsxs)("h4",{className:"font-medium text-lg",children:["Lesson ",e.lesson_number,": ",e.topic]}),a.jsx(c.C,{variant:g(e.status),size:"sm",children:e.status})]}),e.description&&a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:e.description}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(F.Z,{className:"h-3 w-3"}),a.jsx("span",{children:h(e.date)})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(I.Z,{className:"h-3 w-3"}),(0,a.jsxs)("span",{children:[m(e.start_time)," - ",m(e.end_time)]})]}),e.location&&(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(G.Z,{className:"h-3 w-3"}),a.jsx("span",{children:e.location})]}),e.max_students&&(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(V.Z,{className:"h-3 w-3"}),(0,a.jsxs)("span",{children:["Max ",e.max_students]})]})]}),e.schedule&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:["Schedule: ",e.schedule.name]})]}),a.jsx(R.Z,{className:"h-5 w-5 text-gray-400 flex-shrink-0 ml-4"})]})})},e.id))})]})}},24408:(e,t,s)=>{s.d(t,{a:()=>r});let a=(0,s(59813).createClientComponentClient)(),r={async getBooks(e={}){let t=a.from("books").select(`
        *,
        category:categories(id, name, color, icon)
      `).order("created_at",{ascending:!1});e.search&&(t=t.or(`title.ilike.%${e.search}%,author.ilike.%${e.search}%,description.ilike.%${e.search}%`)),e.author&&(t=t.ilike("author",`%${e.author}%`)),e.categoryId&&(t=t.eq("category_id",e.categoryId)),e.contentType&&(t=t.eq("content_type",e.contentType)),e.language&&(t=t.eq("language",e.language)),e.publicationYear&&(t=t.eq("publication_year",e.publicationYear)),void 0!==e.isPublic&&(t=t.eq("is_public",e.isPublic)),e.tags&&e.tags.length>0&&(t=t.contains("tags",e.tags));let{data:s,error:r}=await t;if(r)throw r;return s},async getBook(e){let{data:t,error:s}=await a.from("books").select(`
        *,
        category:categories(id, name, color, icon),
        course_books(
          id,
          course_id,
          is_required,
          notes,
          position,
          course:courses(id, title, status)
        )
      `).eq("id",e).single();if(s)throw s;return t},async createBook(e){let{data:t}=await a.auth.getUser();if(!t.user)throw Error("User not authenticated");let s={...e,language:e.language||"en",is_public:e.is_public||!1,user_id:t.user.id},{data:r,error:i}=await a.from("books").insert(s).select().single();if(i)throw i;return r},async updateBook({id:e,...t}){let{data:s,error:r}=await a.from("books").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(r)throw r;return s},async deleteBook(e){let{error:t}=await a.from("books").delete().eq("id",e);if(t)throw t},async getBookStats(){let{data:e}=await a.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:s}=await a.from("books").select("content_type",{count:"exact"}).eq("user_id",e.user.id);if(s)throw s;return{total:t?.length||0,text:t?.filter(e=>"text"===e.content_type).length||0,video:t?.filter(e=>"video"===e.content_type).length||0,audio:t?.filter(e=>"audio"===e.content_type).length||0,pdf:t?.filter(e=>"pdf"===e.content_type).length||0,other:t?.filter(e=>["image","interactive"].includes(e.content_type)).length||0}},async getAuthors(){let{data:e}=await a.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:s}=await a.from("books").select("author").eq("user_id",e.user.id).not("author","is",null);if(s)throw s;return Array.from(new Set(t?.map(e=>e.author).filter(Boolean))).sort()},async getLanguages(){let{data:e}=await a.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:s}=await a.from("books").select("language").eq("user_id",e.user.id);if(s)throw s;return Array.from(new Set(t?.map(e=>e.language).filter(Boolean))).sort()},getContentTypes:()=>[{value:"text",label:"Text",icon:"\uD83D\uDCC4"},{value:"pdf",label:"PDF",icon:"\uD83D\uDCD1"},{value:"video",label:"Video",icon:"\uD83C\uDFA5"},{value:"audio",label:"Audio",icon:"\uD83C\uDFA7"},{value:"image",label:"Image",icon:"\uD83D\uDDBC️"},{value:"interactive",label:"Interactive",icon:"\uD83C\uDFAE"}]}},59851:(e,t,s)=>{s.d(t,{p:()=>r});let a=(0,s(59813).createClientComponentClient)(),r={async getLessons(e={}){let t=a.from("lessons").select(`
        *,
        schedule:schedules(id, name, course:courses(id, title))
      `).order("date",{ascending:!0}).order("start_time",{ascending:!0});e.schedule_id&&(t=t.eq("schedule_id",e.schedule_id)),e.status&&(t=t.eq("status",e.status)),e.date_from&&(t=t.gte("date",e.date_from)),e.date_to&&(t=t.lte("date",e.date_to)),e.user_id&&(t=t.eq("user_id",e.user_id));let{data:s,error:r}=await t;if(r)throw r;return s},async getScheduleLessons(e){let{data:t,error:s}=await a.from("lessons").select("*").eq("schedule_id",e).order("date",{ascending:!0}).order("start_time",{ascending:!0});if(s)throw s;return t},async getLesson(e){let{data:t,error:s}=await a.from("lessons").select(`
        *,
        schedule:schedules(*, course:courses(*)),
        objectives:lesson_objectives(*, objective:objectives(*)),
        methods:lesson_methods(*, method:methods(*)),
        tasks:lesson_tasks(*, task:tasks(*)),
        books:lesson_books(*, book:books(*)),
        vocabulary:lesson_vocabulary(*, vocabulary:vocabulary(*)),
        attendance(*)
      `).eq("id",e).single();if(s)throw s;return t},async createLesson(e){let{data:t}=await a.auth.getUser();if(!t.user)throw Error("User not authenticated");let{data:s,error:r}=await a.from("lessons").insert({...e,user_id:t.user.id}).select().single();if(r)throw r;return s},async updateLesson(e,t){let{data:s,error:r}=await a.from("lessons").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(r)throw r;return s},async deleteLesson(e){let{error:t}=await a.from("lessons").delete().eq("id",e);if(t)throw t},async getAttendance(e){let{data:t,error:s}=await a.from("attendance").select("*").eq("lesson_id",e).order("student_name");if(s)throw s;return t},async markAttendance(e){let{data:t}=await a.auth.getUser();if(!t.user)throw Error("User not authenticated");let{data:s,error:r}=await a.from("attendance").upsert({...e,marked_at:new Date().toISOString(),marked_by:t.user.id}).select().single();if(r)throw r;return s},async bulkMarkAttendance(e,t){let{data:s}=await a.auth.getUser();if(!s.user)throw Error("User not authenticated");let r=t.map(t=>({...t,lesson_id:e,marked_at:new Date().toISOString(),marked_by:s.user.id})),{data:i,error:o}=await a.from("attendance").upsert(r).select();if(o)throw o;return i}}},81254:(e,t,s)=>{s.d(t,{y:()=>i});let a=(0,s(59813).createClientComponentClient)();async function r(e,t){let s=[],r=new Date(`${t.start_date}T00:00:00Z`),i=t.end_date?new Date(`${t.end_date}T00:00:00Z`):new Date(r.getFullYear()+1,r.getMonth(),r.getDate()),o=new Date(r),l=1,n=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(;o<=i;){let a=n[o.getUTCDay()];if(t.recurrence_days?.includes(a)){let[a,r]=t.default_start_time.split(":").map(Number),i=new Date(o);i.setUTCHours(a,r,0,0);let n=new Date(i);n.setUTCMinutes(i.getUTCMinutes()+t.default_duration_minutes),s.push({schedule_id:e,user_id:t.user_id,title:`${t.name} - Lesson ${l}`,date:o.toISOString().split("T")[0],start_time:i.toUTCString().slice(17,22),end_time:n.toUTCString().slice(17,22),duration_minutes:t.default_duration_minutes,location:t.location,status:"scheduled"}),l++}o.setUTCDate(o.getUTCDate()+1)}if(s.length>0){let{error:e}=await a.from("lessons").insert(s);if(e)throw e}}let i={async getSchedules(e={}){let t=a.from("schedules").select(`
        *,
        course:courses(id, title),
        lessons(count)
      `).order("created_at",{ascending:!1});e.course_id&&(t=t.eq("course_id",e.course_id)),void 0!==e.is_active&&(t=t.eq("is_active",e.is_active)),e.user_id&&(t=t.eq("user_id",e.user_id));let{data:s,error:r}=await t;if(r)throw r;return s},async getSchedule(e){let{data:t,error:s}=await a.from("schedules").select(`
        *,
        course:courses(*),
        lessons(*)
      `).eq("id",e).single();if(s)throw s;return t},async createSchedule(e){let{data:t}=await a.auth.getUser();if(!t.user)throw Error("User not authenticated");let{data:s,error:i}=await a.from("schedules").insert({...e,user_id:t.user.id}).select().single();if(i)throw i;return s&&"none"!==e.recurrence_type&&await r(s.id,{...e,user_id:t.user.id}),s},async updateSchedule(e,t){let{data:s,error:r}=await a.from("schedules").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(r)throw r;return s},async deleteSchedule(e){let{error:t}=await a.from("schedules").delete().eq("id",e);if(t)throw t}}},44778:(e,t,s)=>{s.d(t,{A:()=>r});let a=(0,s(59813).createClientComponentClient)(),r={async getVocabulary(e={}){let t=a.from("vocabulary").select("*").order("word",{ascending:!0});e.search&&(t=t.or(`word.ilike.%${e.search}%,translation.ilike.%${e.search}%,definition.ilike.%${e.search}%`)),e.difficulty&&(t=t.eq("difficulty",e.difficulty)),e.partOfSpeech&&(t=t.eq("part_of_speech",e.partOfSpeech)),e.tags&&e.tags.length>0&&(t=t.contains("tags",e.tags));let{data:s,error:r}=await t;if(r)throw r;return s},async getVocabularyInGroup(e){let{data:t,error:s}=await a.from("vocabulary_group_items").select(`
        *,
        vocabulary(*)
      `).eq("vocabulary_group_id",e).order("position",{ascending:!0});if(s)throw s;return t},async getVocabularyItem(e){let{data:t,error:s}=await a.from("vocabulary").select("*").eq("id",e).single();if(s)throw s;return t},async createVocabulary(e){let{data:t}=await a.auth.getUser();if(!t.user)throw Error("User not authenticated");let s={...e,difficulty:e.difficulty||"beginner",user_id:t.user.id},{data:r,error:i}=await a.from("vocabulary").insert(s).select().single();if(i)throw i;return r},async updateVocabulary({id:e,...t}){let{data:s,error:r}=await a.from("vocabulary").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(r)throw r;return s},async deleteVocabulary(e){let{error:t}=await a.from("vocabulary").delete().eq("id",e);if(t)throw t},async getVocabularyGroups(e={}){let t=a.from("vocabulary_groups").select(`
        *,
        category:categories(id, name, color, icon),
        vocabulary_group_items(count)
      `).order("created_at",{ascending:!1});e.search&&(t=t.or(`name.ilike.%${e.search}%,description.ilike.%${e.search}%`)),e.difficulty&&(t=t.eq("difficulty",e.difficulty)),e.language&&(t=t.eq("language",e.language)),e.targetLanguage&&(t=t.eq("target_language",e.targetLanguage)),e.categoryId&&(t=t.eq("category_id",e.categoryId)),void 0!==e.isPublic&&(t=t.eq("is_public",e.isPublic)),e.tags&&e.tags.length>0&&(t=t.contains("tags",e.tags));let{data:s,error:r}=await t;if(r)throw r;return s?.map(e=>({...e,vocabulary_count:e.vocabulary_group_items?.[0]?.count||0}))||[]},async getVocabularyGroup(e){let{data:t,error:s}=await a.from("vocabulary_groups").select(`
        *,
        category:categories(id, name, color, icon),
        vocabulary_group_items(
          *,
          vocabulary(*)
        )
      `).eq("id",e).single();if(s)throw s;return t},async createVocabularyGroup(e){let{data:t}=await a.auth.getUser();if(!t.user)throw Error("User not authenticated");let s={...e,language:e.language||"en",difficulty:e.difficulty||"beginner",is_public:e.is_public||!1,user_id:t.user.id},{data:r,error:i}=await a.from("vocabulary_groups").insert(s).select().single();if(i)throw i;return r},async updateVocabularyGroup({id:e,...t}){let{data:s,error:r}=await a.from("vocabulary_groups").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(r)throw r;return s},async deleteVocabularyGroup(e){let{error:t}=await a.from("vocabulary_groups").delete().eq("id",e);if(t)throw t},async addVocabularyToGroup(e,t,s){if(void 0===s){let{data:e}=await a.from("vocabulary_group_items").select("position").eq("vocabulary_group_id",t).order("position",{ascending:!1}).limit(1);s=e&&e.length>0?e[0].position+1:0}let{data:r,error:i}=await a.from("vocabulary_group_items").insert({vocabulary_group_id:t,vocabulary_id:e,position:s}).select().single();if(i)throw i;return r},async removeVocabularyFromGroup(e,t){let{error:s}=await a.from("vocabulary_group_items").delete().eq("vocabulary_group_id",t).eq("vocabulary_id",e);if(s)throw s},async updateVocabularyPosition(e,t,s){let{data:r,error:i}=await a.from("vocabulary_group_items").update({position:s}).eq("vocabulary_group_id",t).eq("vocabulary_id",e).select().single();if(i)throw i;return r},async getVocabularyStats(){let{data:e}=await a.auth.getUser();if(!e.user)throw Error("User not authenticated");let[t,s]=await Promise.all([a.from("vocabulary").select("difficulty",{count:"exact"}).eq("user_id",e.user.id),a.from("vocabulary_groups").select("difficulty",{count:"exact"}).eq("user_id",e.user.id)]);if(t.error)throw t.error;if(s.error)throw s.error;return{vocabulary:{total:t.data?.length||0,beginner:t.data?.filter(e=>"beginner"===e.difficulty).length||0,intermediate:t.data?.filter(e=>"intermediate"===e.difficulty).length||0,advanced:t.data?.filter(e=>"advanced"===e.difficulty).length||0,expert:t.data?.filter(e=>"expert"===e.difficulty).length||0},groups:{total:s.data?.length||0,beginner:s.data?.filter(e=>"beginner"===e.difficulty).length||0,intermediate:s.data?.filter(e=>"intermediate"===e.difficulty).length||0,advanced:s.data?.filter(e=>"advanced"===e.difficulty).length||0,expert:s.data?.filter(e=>"expert"===e.difficulty).length||0}}},async getPartsOfSpeech(){let{data:e}=await a.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:s}=await a.from("vocabulary").select("part_of_speech").eq("user_id",e.user.id).not("part_of_speech","is",null);if(s)throw s;return Array.from(new Set(t?.map(e=>e.part_of_speech).filter(Boolean))).sort()},async getLanguages(){let{data:e}=await a.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:s}=await a.from("vocabulary_groups").select("language, target_language").eq("user_id",e.user.id);if(s)throw s;let r=new Set;return t?.forEach(e=>{e.language&&r.add(e.language),e.target_language&&r.add(e.target_language)}),Array.from(r).sort()},getDifficultyLevels:()=>[{value:"beginner",label:"Beginner",color:"green"},{value:"intermediate",label:"Intermediate",color:"yellow"},{value:"advanced",label:"Advanced",color:"orange"},{value:"expert",label:"Expert",color:"red"}],getPartsOfSpeechOptions:()=>[{value:"noun",label:"Noun"},{value:"verb",label:"Verb"},{value:"adjective",label:"Adjective"},{value:"adverb",label:"Adverb"},{value:"pronoun",label:"Pronoun"},{value:"preposition",label:"Preposition"},{value:"conjunction",label:"Conjunction"},{value:"interjection",label:"Interjection"},{value:"article",label:"Article"}]}}};