exports.id=814,exports.ids=[814],exports.modules={16774:(e,t,a)=>{Promise.resolve().then(a.bind(a,95086))},62881:(e,t,a)=>{"use strict";a.d(t,{Z:()=>d});var r=a(17577);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),i=e=>{let t=s(e);return t.charAt(0).toUpperCase()+t.slice(1)},o=(...e)=>e.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim(),n=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,r.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:l,className:s="",children:i,iconNode:u,...d},g)=>(0,r.createElement)("svg",{ref:g,...c,width:t,height:t,stroke:e,strokeWidth:l?24*Number(a)/Number(t):a,className:o("lucide",s),...!i&&!n(d)&&{"aria-hidden":"true"},...d},[...u.map(([e,t])=>(0,r.createElement)(e,t)),...Array.isArray(i)?i:[i]])),d=(e,t)=>{let a=(0,r.forwardRef)(({className:a,...s},n)=>(0,r.createElement)(u,{ref:n,iconNode:t,className:o(`lucide-${l(i(e))}`,`lucide-${e}`,a),...s}));return a.displayName=i(e),a}},86333:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(62881).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},39183:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(62881).Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},83855:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(62881).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},31215:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(62881).Z)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},88307:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(62881).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},94019:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(62881).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},95086:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var r=a(10326),l=a(62760),s=a(80341);function i({children:e}){return r.jsx(s.AuthGuard,{children:r.jsx(l.DashboardLayout,{children:e})})}},6151:(e,t,a)=>{"use strict";a.d(t,{t:()=>h});var r=a(10326),l=a(17577),s=a(35047),i=a(86333),o=a(83855),n=a(94019),c=a(31215),u=a(24408),d=a(78188),g=a(85439);function h({initialData:e}){let t=(0,s.useRouter)(),a=!!e,[h,p]=(0,l.useState)(!1),[m,y]=(0,l.useState)([]),[b,x]=(0,l.useState)(!1),[v,f]=(0,l.useState)(""),[k,j]=(0,l.useState)("#6b7280"),[w,C]=(0,l.useState)({title:e?.title||"",author:e?.author||"",description:e?.description||"",category_id:e?.category_id||"",content_type:e?.content_type||"text",language:e?.language||"en",tags:e?.tags||[],cover_image_url:e?.cover_image_url||"",publication_year:e?.publication_year||"",is_public:e?.is_public||!1}),[_,N]=(0,l.useState)({}),[I,Z]=(0,l.useState)(""),D=async()=>{try{let e=await d.G.getCategories({type:"book"});y(e)}catch(e){console.error("Failed to load categories:",e)}},q=()=>{let e={};return w.title.trim()||(e.title="Title is required"),w.publication_year&&isNaN(Number(w.publication_year))&&(e.publication_year="Publication year must be a number"),N(e),0===Object.keys(e).length},B=async r=>{if(r.preventDefault(),q()){p(!0);try{let r={...w,publication_year:w.publication_year?Number(w.publication_year):void 0};a?await u.a.updateBook({id:e.id,...r}):await u.a.createBook(r),t.push("/books"),t.refresh()}catch(e){console.error("Failed to save book:",e),N({submit:e.message||"Failed to save book. Please try again."})}finally{p(!1)}}},S=()=>{I.trim()&&!w.tags.includes(I.trim())&&(C({...w,tags:[...w.tags,I.trim()]}),Z(""))},A=e=>{C({...w,tags:w.tags.filter(t=>t!==e)})},z=async()=>{if(v.trim())try{let e=await d.G.createCategory({name:v,type:"book",color:k});x(!1),f(""),await D(),C({...w,category_id:e.id})}catch(e){console.error("Failed to create book category:",e)}};return(0,r.jsxs)("form",{onSubmit:B,className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[r.jsx(g.zx,{type:"button",variant:"ghost",size:"sm",onClick:()=>t.back(),leftIcon:r.jsx(i.Z,{className:"h-4 w-4"}),className:"mb-4",children:"Back"}),r.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:a?"Edit Book":"Create New Book"})]}),_.submit&&r.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 rounded-lg",children:_.submit}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(g.Zb,{children:[r.jsx(g.Zb.Header,{children:r.jsx("h2",{className:"text-lg font-semibold",children:"Basic Information"})}),(0,r.jsxs)(g.Zb.Content,{className:"space-y-4",children:[r.jsx(g.II,{label:"Book Title",value:w.title,onChange:e=>C({...w,title:e.target.value}),error:_.title,placeholder:"Enter book title",required:!0}),r.jsx(g.II,{label:"Author",value:w.author,onChange:e=>C({...w,author:e.target.value}),placeholder:"Enter author's name"}),r.jsx(g.gx,{label:"Description",value:w.description,onChange:e=>C({...w,description:e.target.value}),placeholder:"Detailed book description",rows:4}),r.jsx(g.II,{label:"Cover Image URL",type:"url",value:w.cover_image_url,onChange:e=>C({...w,cover_image_url:e.target.value}),placeholder:"https://example.com/image.jpg"})]})]}),(0,r.jsxs)(g.Zb,{children:[r.jsx(g.Zb.Header,{children:r.jsx("h2",{className:"text-lg font-semibold",children:"Details & Categorization"})}),(0,r.jsxs)(g.Zb.Content,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"md:col-span-1",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(g.Ph,{className:"flex-grow",value:w.category_id,onChange:e=>C({...w,category_id:e.target.value}),options:[{value:"",label:"Select category"},...m.map(e=>({value:e.id,label:e.name}))]}),r.jsx(g.zx,{type:"button",variant:"outline",size:"md",onClick:()=>x(!0),className:"flex-shrink-0 !h-10",children:r.jsx(o.Z,{className:"h-4 w-4"})})]})]}),r.jsx(g.II,{label:"Publication Year",type:"number",value:w.publication_year,onChange:e=>C({...w,publication_year:e.target.value}),error:_.publication_year,placeholder:"e.g., 2023"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(g.Ph,{label:"Content Type",value:w.content_type,onChange:e=>C({...w,content_type:e.target.value}),options:u.a.getContentTypes()}),r.jsx(g.II,{label:"Language",value:w.language,onChange:e=>C({...w,language:e.target.value}),placeholder:"e.g., en"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 pt-2",children:[r.jsx("input",{type:"checkbox",id:"is_public",checked:w.is_public,onChange:e=>C({...w,is_public:e.target.checked}),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),r.jsx("label",{htmlFor:"is_public",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Make this book publicly accessible"})]})]})]}),(0,r.jsxs)(g.Zb,{children:[r.jsx(g.Zb.Header,{children:r.jsx("h2",{className:"text-lg font-semibold",children:"Tags"})}),(0,r.jsxs)(g.Zb.Content,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx(g.II,{value:I,onChange:e=>Z(e.target.value),placeholder:"Add a tag",onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),S())}}),r.jsx(g.zx,{type:"button",onClick:S,leftIcon:r.jsx(o.Z,{className:"h-4 w-4"}),children:"Add"})]}),w.tags.length>0&&r.jsx("div",{className:"flex flex-wrap gap-2",children:w.tags.map(e=>(0,r.jsxs)(g.Ct,{variant:"secondary",className:"px-3 py-1",children:[e,r.jsx("button",{type:"button",onClick:()=>A(e),className:"ml-2 hover:text-red-500",children:r.jsx(n.Z,{className:"h-3 w-3"})})]},e))})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-3",children:[r.jsx(g.zx,{type:"button",variant:"outline",onClick:()=>t.push("/books"),children:"Cancel"}),r.jsx(g.zx,{type:"submit",loading:h,leftIcon:r.jsx(c.Z,{className:"h-4 w-4"}),children:a?"Update Book":"Create Book"})]})]}),(0,r.jsxs)(g.u_,{isOpen:b,onClose:()=>x(!1),title:"Create New Book Category",size:"sm",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx(g.II,{label:"Category Name",value:v,onChange:e=>f(e.target.value),placeholder:"e.g., Fiction, Science, etc.",required:!0}),r.jsx(g.II,{label:"Category Color",type:"color",value:k,onChange:e=>j(e.target.value),className:"h-10"})]}),(0,r.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[r.jsx(g.zx,{variant:"ghost",onClick:()=>x(!1),children:"Cancel"}),r.jsx(g.zx,{onClick:z,children:"Create Category"})]})]})]})}},24408:(e,t,a)=>{"use strict";a.d(t,{a:()=>l});let r=(0,a(59813).createClientComponentClient)(),l={async getBooks(e={}){let t=r.from("books").select(`
        *,
        category:categories(id, name, color, icon)
      `).order("created_at",{ascending:!1});e.search&&(t=t.or(`title.ilike.%${e.search}%,author.ilike.%${e.search}%,description.ilike.%${e.search}%`)),e.author&&(t=t.ilike("author",`%${e.author}%`)),e.categoryId&&(t=t.eq("category_id",e.categoryId)),e.contentType&&(t=t.eq("content_type",e.contentType)),e.language&&(t=t.eq("language",e.language)),e.publicationYear&&(t=t.eq("publication_year",e.publicationYear)),void 0!==e.isPublic&&(t=t.eq("is_public",e.isPublic)),e.tags&&e.tags.length>0&&(t=t.contains("tags",e.tags));let{data:a,error:l}=await t;if(l)throw l;return a},async getBook(e){let{data:t,error:a}=await r.from("books").select(`
        *,
        category:categories(id, name, color, icon),
        course_books(
          id,
          course_id,
          is_required,
          notes,
          position,
          course:courses(id, title, status)
        )
      `).eq("id",e).single();if(a)throw a;return t},async createBook(e){let{data:t}=await r.auth.getUser();if(!t.user)throw Error("User not authenticated");let a={...e,language:e.language||"en",is_public:e.is_public||!1,user_id:t.user.id},{data:l,error:s}=await r.from("books").insert(a).select().single();if(s)throw s;return l},async updateBook({id:e,...t}){let{data:a,error:l}=await r.from("books").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(l)throw l;return a},async deleteBook(e){let{error:t}=await r.from("books").delete().eq("id",e);if(t)throw t},async getBookStats(){let{data:e}=await r.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:a}=await r.from("books").select("content_type",{count:"exact"}).eq("user_id",e.user.id);if(a)throw a;return{total:t?.length||0,text:t?.filter(e=>"text"===e.content_type).length||0,video:t?.filter(e=>"video"===e.content_type).length||0,audio:t?.filter(e=>"audio"===e.content_type).length||0,pdf:t?.filter(e=>"pdf"===e.content_type).length||0,other:t?.filter(e=>["image","interactive"].includes(e.content_type)).length||0}},async getAuthors(){let{data:e}=await r.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:a}=await r.from("books").select("author").eq("user_id",e.user.id).not("author","is",null);if(a)throw a;return Array.from(new Set(t?.map(e=>e.author).filter(Boolean))).sort()},async getLanguages(){let{data:e}=await r.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:a}=await r.from("books").select("language").eq("user_id",e.user.id);if(a)throw a;return Array.from(new Set(t?.map(e=>e.language).filter(Boolean))).sort()},getContentTypes:()=>[{value:"text",label:"Text",icon:"\uD83D\uDCC4"},{value:"pdf",label:"PDF",icon:"\uD83D\uDCD1"},{value:"video",label:"Video",icon:"\uD83C\uDFA5"},{value:"audio",label:"Audio",icon:"\uD83C\uDFA7"},{value:"image",label:"Image",icon:"\uD83D\uDDBC️"},{value:"interactive",label:"Interactive",icon:"\uD83C\uDFAE"}]}},78188:(e,t,a)=>{"use strict";a.d(t,{G:()=>l});let r=(0,a(59813).createClientComponentClient)(),l={async getCategories(e={}){let t=r.from("categories").select("*").order("name",{ascending:!0});e.type&&(t=t.eq("type",e.type)),void 0!==e.parentId&&(t=t.eq("parent_id",e.parentId)),e.search&&(t=t.ilike("name",`%${e.search}%`));let{data:a,error:l}=await t;if(l)throw l;return a},async getCategory(e){let{data:t,error:a}=await r.from("categories").select("*").eq("id",e).single();if(a)throw a;return t},async createCategory(e){let{data:t}=await r.auth.getUser();if(!t.user)throw Error("User not authenticated");let{data:a,error:l}=await r.from("categories").insert({...e,user_id:t.user.id}).select().single();if(l)throw l;return a},async updateCategory({id:e,...t}){let{data:a,error:l}=await r.from("categories").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(l)throw l;return a},async deleteCategory(e){let{error:t}=await r.from("categories").delete().eq("id",e);if(t)throw t},getCategoryTypes:()=>[{value:"course",label:"Course"},{value:"book",label:"Book"},{value:"vocabulary",label:"Vocabulary"},{value:"objective",label:"Objective"},{value:"method",label:"Method"},{value:"task",label:"Task"}]}},73702:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>i,__esModule:()=>s,default:()=>o});var r=a(68570);let l=(0,r.createProxy)(String.raw`D:\dev\cursor\course builder\src\app\books\layout.tsx`),{__esModule:s,$$typeof:i}=l;l.default;let o=(0,r.createProxy)(String.raw`D:\dev\cursor\course builder\src\app\books\layout.tsx#default`)},79360:(e,t,a)=>{"use strict";a.d(t,{j:()=>i});var r=a(41135);let l=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,s=r.W,i=(e,t)=>a=>{var r;if((null==t?void 0:t.variants)==null)return s(e,null==a?void 0:a.class,null==a?void 0:a.className);let{variants:i,defaultVariants:o}=t,n=Object.keys(i).map(e=>{let t=null==a?void 0:a[e],r=null==o?void 0:o[e];if(null===t)return null;let s=l(t)||l(r);return i[e][s]}),c=a&&Object.entries(a).reduce((e,t)=>{let[a,r]=t;return void 0===r||(e[a]=r),e},{});return s(e,n,null==t?void 0:null===(r=t.compoundVariants)||void 0===r?void 0:r.reduce((e,t)=>{let{class:a,className:r,...l}=t;return Object.entries(l).every(e=>{let[t,a]=e;return Array.isArray(a)?a.includes({...o,...c}[t]):({...o,...c})[t]===a})?[...e,a,r]:e},[]),null==a?void 0:a.class,null==a?void 0:a.className)}}};